<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solidity Security Analyzer Pro - Dark Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-tertiary: #1a1a1a;
            --bg-card: #161616;
            --primary: #3b82f6;
            --primary-light: #60a5fa;
            --primary-dark: #1d4ed8;
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #10b981;
            --info: #06b6d4;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #64748b;
            --border: #2d2d2d;
            --border-light: #404040;
            --shadow: rgba(0, 0, 0, 0.5);
            --shadow-lg: rgba(0, 0, 0, 0.7);
            --gradient-primary: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            --gradient-danger: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            --gradient-success: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        body {
            font-family: 'Vazirmatn', -apple-system, BlinkMacSystemFont, 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.7;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(59, 130, 246, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(16, 185, 129, 0.15) 0%, transparent 50%);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 80px 30px;
            background: var(--bg-card);
            border-radius: 24px;
            border: 1px solid var(--border);
            box-shadow: 0 8px 32px var(--shadow);
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: var(--gradient-primary);
        }
        
        .header h1 {
            font-size: 3.5rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            letter-spacing: -0.02em;
        }
        
        .header p {
            font-size: 1.25rem;
            color: var(--text-secondary);
            max-width: 700px;
            margin: 0 auto;
            font-weight: 400;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: start;
        }
        
        .input-panel, .results-panel {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 35px;
            border: 1px solid var(--border);
            box-shadow: 0 8px 32px var(--shadow);
            backdrop-filter: blur(10px);
        }
        
        .panel-title {
            font-size: 1.75rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .code-textarea {
            width: 100%;
            height: 450px;
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 25px;
            font-family: 'JetBrains Mono', 'SF Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
            background: var(--bg-secondary);
            color: var(--text-primary);
            resize: vertical;
            transition: all 0.3s ease;
        }
        
        .code-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.15);
            background: var(--bg-tertiary);
        }
        
        .analyze-btn {
            width: 100%;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 16px;
            padding: 20px 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 25px;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            overflow: hidden;
        }
        
        .analyze-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .analyze-btn:hover:not(:disabled)::before {
            left: 100%;
        }
        
        .analyze-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(59, 130, 246, 0.4);
        }
        
        .analyze-btn:disabled {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            cursor: not-allowed;
            transform: none;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 18px;
            margin-bottom: 35px;
        }
        
        .stat-card {
            background: var(--bg-secondary);
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient-primary);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
        }
        
        .stat-card:hover::before {
            transform: scaleX(1);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-primary);
        }
        
        .stat-label {
            color: var(--text-muted);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .vulnerability-card {
            border: 1px solid var(--border);
            border-radius: 16px;
            margin-bottom: 20px;
            overflow: hidden;
            background: var(--bg-secondary);
            transition: all 0.3s ease;
        }
        
        .vulnerability-card:hover {
            border-color: var(--border-light);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .vulnerability-header {
            padding: 25px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .vulnerability-header:hover {
            background: var(--bg-tertiary);
        }
        
        .severity-critical .vulnerability-header { border-right: 4px solid var(--danger); }
        .severity-high .vulnerability-header { border-right: 4px solid #f97316; }
        .severity-medium .vulnerability-header { border-right: 4px solid var(--warning); }
        .severity-low .vulnerability-header { border-right: 4px solid var(--success); }
        .severity-info .vulnerability-header { border-right: 4px solid var(--info); }
        
        .vulnerability-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .vulnerability-meta {
            font-size: 0.9rem;
            color: var(--text-muted);
            line-height: 1.4;
        }
        
        .vulnerability-details {
            padding: 0 25px 25px;
            display: none;
            animation: slideDown 0.4s ease;
            border-top: 1px solid var(--border);
            background: var(--bg-tertiary);
        }
        
        .vulnerability-details.active {
            display: block;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .section-title {
            color: var(--primary-light);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 25px 0 15px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .code-block {
            background: var(--bg-primary);
            color: #e2e8f0;
            padding: 20px;
            border-radius: 12px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            margin: 15px 0;
            overflow-x: auto;
            border: 1px solid var(--border);
            line-height: 1.6;
        }
        
        .attack-scenario {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.05) 100%);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .attack-scenario h4 {
            color: #fca5a5;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .attack-steps {
            margin: 15px 0;
        }
        
        .attack-step {
            background: rgba(0, 0, 0, 0.3);
            border-right: 3px solid var(--danger);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .attack-step strong {
            color: #fca5a5;
        }
        
        .recommendation {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.05) 100%);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .recommendation h4 {
            color: #6ee7b7;
            margin-bottom: 12px;
        }
        
        .advanced-analysis {
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.1) 0%, rgba(14, 165, 233, 0.05) 100%);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .advanced-analysis h4 {
            color: #67e8f9;
            margin-bottom: 12px;
        }
        
        .loading {
            text-align: center;
            padding: 80px 20px;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--border);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 25px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .no-results {
            text-align: center;
            padding: 80px 20px;
            color: var(--text-muted);
        }
        
        .no-results.success {
            color: var(--success);
        }
        
        .expand-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
            color: var(--text-muted);
        }
        
        .expand-icon.rotated {
            transform: rotate(180deg);
        }
        
        .severity-badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .severity-critical { background: rgba(239, 68, 68, 0.2); color: #fca5a5; border: 1px solid rgba(239, 68, 68, 0.4); }
        .severity-high { background: rgba(249, 115, 22, 0.2); color: #fed7aa; border: 1px solid rgba(249, 115, 22, 0.4); }
        .severity-medium { background: rgba(245, 158, 11, 0.2); color: #fde68a; border: 1px solid rgba(245, 158, 11, 0.4); }
        .severity-low { background: rgba(16, 185, 129, 0.2); color: #6ee7b7; border: 1px solid rgba(16, 185, 129, 0.4); }
        .severity-info { background: rgba(6, 182, 212, 0.2); color: #67e8f9; border: 1px solid rgba(6, 182, 212, 0.4); }
        
        .impact-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            margin: 0 5px;
        }
        
        .impact-financial { background: rgba(239, 68, 68, 0.15); color: #f87171; }
        .impact-dos { background: rgba(245, 158, 11, 0.15); color: #fbbf24; }
        .impact-privacy { background: rgba(139, 92, 246, 0.15); color: #a78bfa; }
        .impact-governance { background: rgba(16, 185, 129, 0.15); color: #34d399; }
        
        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .input-panel, .results-panel {
                padding: 25px;
            }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border-light);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ğŸ›¡ï¸ Solidity Security Pro</h1>
            <p>ØªØ­Ù„ÛŒÙ„Ú¯Ø± ÙÙˆÙ‚â€ŒÙ¾ÛŒØ´Ø±ÙØªÙ‡ Ø§Ù…Ù†ÛŒØª Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯Ù‡Ø§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ ØªØ´Ø®ÛŒØµ Ø­Ù…Ù„Ø§Øª Ù¾ÛŒÚ†ÛŒØ¯Ù‡</p>
        </header>
        
        <div class="main-grid">
            <div class="input-panel">
                <h2 class="panel-title">
                    ğŸ“ Ú©Ø¯ Solidity
                </h2>
                <textarea 
                    id="solidityCode" 
                    class="code-textarea" 
                    placeholder="// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract VulnerableContract {
    mapping(address => uint256) public balances;
    
    function deposit() public payable {
        balances[msg.sender] += msg.value;
    }
    
    function withdraw() public {
        uint256 amount = balances[msg.sender];
        require(amount > 0, 'No balance');
        
        (bool success, ) = msg.sender.call{value: amount}('');
        require(success, 'Transfer failed');
        
        balances[msg.sender] = 0;
    }
}">
                </textarea>
                <button id="analyzeBtn" class="analyze-btn">
                    <span id="btnText">ğŸ” ØªØ­Ù„ÛŒÙ„ Ø§Ù…Ù†ÛŒØªÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</span>
                </button>
            </div>
            
            <div class="results-panel">
                <h2 class="panel-title">
                    ğŸ“Š Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„
                </h2>
                <div id="results">
                    <div class="no-results">
                        Ú©Ø¯ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¯Ú©Ù…Ù‡ ØªØ­Ù„ÛŒÙ„ Ø±Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class UltimateSecurityAnalyzer {
            constructor() {
                this.patterns = this.initializeAdvancedPatterns();
                this.advancedChecks = this.initializeAdvancedChecks();
                this.attackScenarios = this.initializeAttackScenarios();
                this.setupEventListeners();
            }

            initializeAdvancedPatterns() {
                return {
                    reentrancy: {
                        patterns: [
                            /\.call\s*\{[^}]*value[^}]*\}[^;]*;(?!\s*balances\[[^\]]+\]\s*=\s*0)/g,
                            /\.transfer\s*\([^)]+\)[^;]*;(?=.*balances\[[^\]]+\]\s*=)/g,
                            /payable\([^)]+\)\.call/g,
                            /msg\.sender\.call\{value:/g,
                            /external.*view.*returns.*\{[^}]*balances/gs
                        ],
                        antiPatterns: [
                            /nonReentrant/gi,
                            /ReentrancyGuard/gi,
                            /require\s*\(\s*!locked/gi,
                            /locked\s*=\s*true/g,
                            /balances\[[^\]]+\]\s*=\s*0.*\.call/gs,
                            /_beforeTokenTransfer/g
                        ],
                        severity: 'critical',
                        title: 'Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ Reentrancy',
                        description: 'Ø§Ù…Ú©Ø§Ù† Ø­Ù…Ù„Ù‡ Reentrancy ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯ Ú©Ù‡ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ù…Ù†Ø¬Ø± Ø¨Ù‡ ØªØ®Ù„ÛŒÙ‡ Ú©Ø§Ù…Ù„ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ø´ÙˆØ¯',
                        impact: ['financial', 'dos'],
                        gasImpact: 'high',
                        cwe: 'CWE-841'
                    },

                    flashLoanAttack: {
                        patterns: [
                            /function\s+\w+[^{]*\{[^}]*balanceOf[^}]*transfer[^}]*\}/gs,
                            /\.transferFrom\s*\([^)]*\)[^;]*;(?=.*price)/g,
                            /price\s*=.*balanceOf/g,
                            /getAmountOut[^;]*;[^}]*transfer/gs
                        ],
                        antiPatterns: [
                            /oracle/gi,
                            /chainlink/gi,
                            /twap/gi,
                            /require\s*\([^)]*block\.timestamp[^)]*lastUpdate/g
                        ],
                        severity: 'critical',
                        title: 'Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ Flash Loan Attack',
                        description: 'Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± Ø­Ù…Ù„Ø§Øª Flash Loan Ú©Ù‡ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ Ø±Ø§ Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯ØŒ Ù…Ø­Ø§ÙØ¸Øª Ù†Ø´Ø¯Ù‡',
                        impact: ['financial'],
                        gasImpact: 'medium',
                        cwe: 'CWE-20'
                    },

                    frontRunning: {
                        patterns: [
                            /function\s+\w+[^{]*public[^{]*\{[^}]*transfer[^}]*\}/gs,
                            /function\s+\w+[^{]*external[^{]*\{[^}]*approve[^}]*\}/gs,
                            /function\s+buy[^{]*\{[^}]*price[^}]*\}/gs,
                            /function\s+sell[^{]*\{[^}]*price[^}]*\}/gs
                        ],
                        antiPatterns: [
                            /commit.*reveal/gi,
                            /timelock/gi,
                            /private/g,
                            /onlyOwner/g,
                            /maxSlippage/gi
                        ],
                        severity: 'high',
                        title: 'Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ Front-Running/MEV',
                        description: 'ØªÙˆØ§Ø¨Ø¹ Ø­Ø³Ø§Ø³ Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª ØªÙˆØ³Ø· Ø¨Ø§Øªâ€ŒÙ‡Ø§ÛŒ MEV Ù…ÙˆØ±Ø¯ Ø³ÙˆØ¡Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù‚Ø±Ø§Ø± Ú¯ÛŒØ±Ù†Ø¯',
                        impact: ['financial'],
                        gasImpact: 'low',
                        cwe: 'CWE-362'
                    },

                    accessControlBypass: {
                        patterns: [
                            /function\s+\w+[^{]*public[^{]*payable[^{]*\{/g,
                            /function\s+\w+[^{]*external[^{]*payable[^{]*\{/g,
                            /selfdestruct\s*\(/g,
                            /delegatecall\s*\(/g,
                            /assembly\s*\{[^}]*sstore[^}]*\}/gs
                        ],
                        antiPatterns: [
                            /onlyOwner/g,
                            /require\s*\(\s*msg\.sender\s*==\s*owner/g,
                            /modifier\s+only\w+/g,
                            /hasRole\s*\(/g,
                            /_checkOwner\s*\(/g,
                            /AccessControl/g
                        ],
                        severity: 'critical',
                        title: 'Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ù†Ø§Ú©Ø§ÙÛŒ',
                        description: 'ØªÙˆØ§Ø¨Ø¹ Ø­Ø³Ø§Ø³ Ø¨Ø¯ÙˆÙ† Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ù†Ø§Ø³Ø¨ Ú©Ù‡ Ø§Ø¬Ø§Ø²Ù‡ Ø¯Ø³ØªØ±Ø³ÛŒ ØºÛŒØ±Ù…Ø¬Ø§Ø² Ø±Ø§ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯',
                        impact: ['financial', 'governance'],
                        gasImpact: 'low',
                        cwe: 'CWE-862'
                    },

                    integerOverflow: {
                        patterns: [
                            /\+\+\w+|--\w+|\w\+\+|\w--/g,
                            /[\w\[\]\.]+\s*[\+\-\*\/]\s*=\s*\w+/g,
                            /unchecked\s*\{[^}]*[\+\-\*\/][^}]*\}/gs,
                            /\w+\s*\*\s*\w+\s*\/\s*\w+/g
                        ],
                        antiPatterns: [
                            /pragma\s+solidity\s+[\^~>=<\s]*0\.8/g,
                            /SafeMath/g,
                            /require\s*\([^)]*overflow[^)]*\)/gi,
                            /Math\.add|Math\.sub|Math\.mul/g
                        ],
                        severity: 'medium',
                        title: 'Ø§Ø­ØªÙ…Ø§Ù„ Integer Overflow/Underflow',
                        description: 'Ø¹Ù…Ù„ÛŒØ§Øª Ø±ÛŒØ§Ø¶ÛŒ Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ overflow ÛŒØ§ underflow Ø´ÙˆØ¯',
                        impact: ['financial'],
                        gasImpact: 'low',
                        cwe: 'CWE-190'
                    },

                    oracleManipulation: {
                        patterns: [
                            /price\s*=.*balanceOf/g,
                            /getPrice[^;]*;(?!.*oracle)/g,
                            /\.balanceOf\s*\([^)]*\)[^;]*;[^}]*price/gs,
                            /this\.balance[^;]*;[^}]*price/gs
                        ],
                        antiPatterns: [
                            /chainlink/gi,
                            /oracle/gi,
                            /twap/gi,
                            /require\s*\([^)]*minPrice[^)]*maxPrice/g
                        ],
                        severity: 'high',
                        title: 'Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ Ù‚ÛŒÙ…Øª Oracle',
                        description: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…Ù†Ø§Ø¨Ø¹ Ù‚ÛŒÙ…Øª Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ø³ÙˆØ¡Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´ÙˆØ¯',
                        impact: ['financial'],
                        gasImpact: 'medium',
                        cwe: 'CWE-20'
                    },

                    timestampManipulation: {
                        patterns: [
                            /block\.timestamp\s*[<>=!]+\s*\w+/g,
                            /now\s*[<>=!]+\s*\w+/g,
                            /require\s*\([^)]*block\.timestamp[^)]*\)/g,
                            /if\s*\([^)]*block\.timestamp[^)]*\)/g,
                            /block\.timestamp\s*\%/g
                        ],
                        antiPatterns: [
                            /block\.number/g,
                            /oracle/gi,
                            /chainlink/gi,
                            /\+\s*\d+\s*minutes/g
                        ],
                        severity: 'medium',
                        title: 'ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒ Ø®Ø·Ø±Ù†Ø§Ú© Ø¨Ù‡ Ø²Ù…Ø§Ù†',
                        description: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² block.timestamp Ú©Ù‡ ØªÙˆØ³Ø· Ù…Ø§ÛŒÙ†Ø±Ù‡Ø§ Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ Ø§Ø³Øª',
                        impact: ['financial', 'governance'],
                        gasImpact: 'low',
                        cwe: 'CWE-367'
                    },

                    txOrigin: {
                        patterns: [
                            /tx\.origin/g
                        ],
                        antiPatterns: [
                            /msg\.sender/g
                        ],
                        severity: 'high',
                        title: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø®Ø·Ø±Ù†Ø§Ú© Ø§Ø² tx.origin',
                        description: 'tx.origin Ø¨Ù‡ Ø¬Ø§ÛŒ msg.sender Ú©Ù‡ Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ phishing Ù…ÛŒâ€ŒØ´ÙˆØ¯',
                        impact: ['financial', 'governance'],
                        gasImpact: 'low',
                        cwe: 'CWE-346'
                    },

                    weakRandomness: {
                        patterns: [
                            /keccak256\s*\([^)]*block\.(timestamp|number|difficulty)[^)]*\)/g,
                            /blockhash\s*\([^)]*\)\s*%/g,
                            /block\.difficulty\s*%/g,
                            /uint\s*\([^)]*block\.timestamp[^)]*\)\s*%/g
                        ],
                        antiPatterns: [
                            /VRF/gi,
                            /oracle/gi,
                            /chainlink/gi,
                            /commit.*reveal/gi,
                            /nonce/gi
                        ],
                        severity: 'high',
                        title: 'ØªÙˆÙ„ÛŒØ¯ Ø¹Ø¯Ø¯ ØªØµØ§Ø¯ÙÛŒ Ø¶Ø¹ÛŒÙ',
                        description: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…Ù†Ø§Ø¨Ø¹ Ù‚Ø§Ø¨Ù„ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¹Ø¯Ø¯ ØªØµØ§Ø¯ÙÛŒ',
                        impact: ['financial', 'governance'],
                        gasImpact: 'low',
                        cwe: 'CWE-338'
                    },

                    dangerousDelegatecall: {
                        patterns: [
                            /\.delegatecall\s*\(/g,
                            /assembly\s*\{[^}]*delegatecall[^}]*\}/gs,
                            /proxy[^{]*\{[^}]*delegatecall[^}]*\}/gs
                        ],
                        antiPatterns: [
                            /require\s*\([^)]*success[^)]*\)/g,
                            /onlyOwner/g,
                            /whitelist/gi,
                            /approved/gi
                        ],
                        severity: 'critical',
                        title: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø®Ø·Ø±Ù†Ø§Ú© Ø§Ø² delegatecall',
                        description: 'delegatecall Ø¨Ø¯ÙˆÙ† Ú©Ù†ØªØ±Ù„ Ù…Ù†Ø§Ø³Ø¨ Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø¯ Ù…Ø®Ø±Ø¨ Ø´ÙˆØ¯',
                        impact: ['financial', 'governance'],
                        gasImpact: 'high',
                        cwe: 'CWE-250'
                    },

                    gasLimitDoS: {
                        patterns: [
                            /for\s*\([^{]*\.length[^{]*\)\s*\{[^}]*\}/gs,
                            /while\s*\([^{]*\.length[^{]*\)\s*\{[^}]*\}/gs,
                            /\.push\s*\([^)]*\)[^;]*;[^}]*\.length/gs,
                            /for\s*\([^)]*;\s*i\s*<[^;]*\.length/g
                        ],
                        antiPatterns: [
                            /require\s*\([^)]*\.length\s*[<>][^)]*\)/g,
                            /break\s*;/g,
                            /if\s*\([^)]*gas[^)]*\)\s*break/gi,
                            /maxIterations/gi
                        ],
                        severity: 'medium',
                        title: 'Ø­Ù…Ù„Ù‡ DoS Ø¨Ø§ Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ú¯Ø§Ø²',
                        description: 'Ø­Ù„Ù‚Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯ Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ø§ØªÙ…Ø§Ù… Ú¯Ø§Ø² Ø´ÙˆØ¯',
                        impact: ['dos'],
                        gasImpact: 'critical',
                        cwe: 'CWE-400'
                    },

                    uncheckedExternalCalls: {
                        patterns: [
                            /\.call\s*\([^)]*\)\s*;/g,
                            /\.send\s*\([^)]*\)\s*;/g,
                            /\.transfer\s*\([^)]*\)\s*;/g,
                            /\.delegatecall\s*\([^)]*\)\s*;/g
                        ],
                        antiPatterns: [
                            /require\s*\([^)]*\.call[^)]*\)/g,
                            /require\s*\([^)]*\.send[^)]*\)/g,
                            /\(bool\s+success[^)]*\)\s*=.*\.call/g,
                            /if\s*\([^)]*success[^)]*\)/g
                        ],
                        severity: 'high',
                        title: 'ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒâ€ŒÙ‡Ø§ÛŒ Ø®Ø§Ø±Ø¬ÛŒ Ø¨Ø¯ÙˆÙ† Ø¨Ø±Ø±Ø³ÛŒ',
                        description: 'ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒâ€ŒÙ‡Ø§ÛŒ Ø®Ø§Ø±Ø¬ÛŒ Ø¨Ø¯ÙˆÙ† Ø¨Ø±Ø±Ø³ÛŒ Ù†ØªÛŒØ¬Ù‡ Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ø´Ú©Ø³Øª Ø®Ø§Ù…ÙˆØ´ Ø´ÙˆØ¯',
                        impact: ['financial'],
                        gasImpact: 'medium',
                        cwe: 'CWE-252'
                    }
                };
            }

            initializeAdvancedChecks() {
                return {
                    // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù¾ÛŒÚ†ÛŒØ¯Ù‡ Ø§Ù…Ù†ÛŒØªÛŒ
                    complexPatterns: [
                        {
                            name: 'sandwich_attack_vulnerability',
                            check: (code) => {
                                const hasAmm = /getAmountOut|swapExactTokensFor|addLiquidity/gi.test(code);
                                const hasSlippage = /slippage|minAmountOut|deadline/gi.test(code);
                                return hasAmm && !hasSlippage;
                            },
                            severity: 'high',
                            title: 'Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ Sandwich Attack',
                            description: 'Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± Ø­Ù…Ù„Ø§Øª Sandwich Ø¯Ø± DEX Ù…Ø­Ø§ÙØ¸Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª'
                        },
                        {
                            name: 'governance_attack',
                            check: (code) => {
                                const hasVoting = /vote|proposal|governance/gi.test(code);
                                const hasTimelock = /timelock|delay|waiting/gi.test(code);
                                return hasVoting && !hasTimelock;
                            },
                            severity: 'critical',
                            title: 'Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ Ø­Ù…Ù„Ù‡ Ø¨Ù‡ Ø­Ø§Ú©Ù…ÛŒØª',
                            description: 'Ø³ÛŒØ³ØªÙ… Ø­Ø§Ú©Ù…ÛŒØª Ø¨Ø¯ÙˆÙ† timelock Ú©Ù‡ Ø§Ù…Ú©Ø§Ù† Ø­Ù…Ù„Ø§Øª flash loan Ø±Ø§ ÙØ±Ø§Ù‡Ù… Ù…ÛŒâ€ŒÚ©Ù†Ø¯'
                        },
                        {
                            name: 'state_bloating',
                            check: (code) => {
                                const hasDynamicArrays = /\[\]\s+public|\[\]\s+private/g.test(code);
                                const hasLengthControl = /require\s*\([^)]*\.length\s*</g.test(code);
                                return hasDynamicArrays && !hasLengthControl;
                            },
                            severity: 'medium',
                            title: 'Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ State Bloating',
                            description: 'Ø¢Ø±Ø§ÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯ Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ø§Ù†ØªÙØ§Ø® state Ø´ÙˆÙ†Ø¯'
                        }
                    ]
                };
            }

            initializeAttackScenarios() {
                return {
                    reentrancy: {
                        title: "Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Ø­Ù…Ù„Ù‡ Reentrancy",
                        steps: [
                            "Ù…Ù‡Ø§Ø¬Ù… ÛŒÚ© Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ù…Ø®Ø±Ø¨ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ú©Ù‡ ØªØ§Ø¨Ø¹ fallback Ø¯Ø§Ø±Ø¯",
                            "Ù…Ù‡Ø§Ø¬Ù… Ù…Ù‚Ø¯Ø§Ø±ÛŒ Ø§ØªØ± Ø¯Ø± Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ù‡Ø¯Ù deposit Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "Ù…Ù‡Ø§Ø¬Ù… ØªØ§Ø¨Ø¹ withdraw Ø±Ø§ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "Ø¯Ø± Ù‡Ù†Ú¯Ø§Ù… Ø¯Ø±ÛŒØ§ÙØª Ø§ØªØ±ØŒ ØªØ§Ø¨Ø¹ fallback Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ù…Ù‡Ø§Ø¬Ù… Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯",
                            "ØªØ§Ø¨Ø¹ fallback Ø¯ÙˆØ¨Ø§Ø±Ù‡ withdraw Ø±Ø§ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Ù‚Ø¨Ù„ Ø§Ø² ØµÙØ± Ø´Ø¯Ù† balance)",
                            "Ø§ÛŒÙ† ÙØ±Ø¢ÛŒÙ†Ø¯ ØªØ§ Ø²Ù…Ø§Ù† ØªØ®Ù„ÛŒÙ‡ Ú©Ø§Ù…Ù„ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ø§Ø¯Ø§Ù…Ù‡ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯"
                        ],
                        impact: "ØªØ®Ù„ÛŒÙ‡ Ú©Ø§Ù…Ù„ ÙˆØ¬ÙˆÙ‡ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ø¯Ø± ÛŒÚ© ØªØ±Ø§Ú©Ù†Ø´",
                        prevention: "Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§Ù„Ú¯ÙˆÛŒ Checks-Effects-Interactions Ùˆ ReentrancyGuard"
                    },

                    flashLoanAttack: {
                        title: "Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Ø­Ù…Ù„Ù‡ Flash Loan",
                        steps: [
                            "Ù…Ù‡Ø§Ø¬Ù… Ù…Ù‚Ø¯Ø§Ø± Ø²ÛŒØ§Ø¯ÛŒ ØªÙˆÚ©Ù† Ø±Ø§ Ø§Ø² Ø·Ø±ÛŒÙ‚ Flash Loan Ù‚Ø±Ø¶ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯",
                            "Ø¨Ø§ Ø§ÛŒÙ† Ù…Ù‚Ø¯Ø§Ø± Ø²ÛŒØ§Ø¯ØŒ Ù‚ÛŒÙ…Øª Ø¯Ø± AMM Ø±Ø§ Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "Ø§Ø² Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ù‡Ø¯Ù Ú©Ù‡ Ø§Ø² Ù‡Ù…ÛŒÙ† AMM Ø¨Ø±Ø§ÛŒ Ù‚ÛŒÙ…Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŒ Ø³ÙˆØ¡Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "Ø³ÙˆØ¯ Ú©Ø³Ø¨ Ø´Ø¯Ù‡ Ø±Ø§ Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ùˆ Flash Loan Ø±Ø§ Ù¾Ø³ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯",
                            "Ù‡Ù…Ù‡ Ø§ÛŒÙ† Ú©Ø§Ø±Ù‡Ø§ Ø¯Ø± ÛŒÚ© ØªØ±Ø§Ú©Ù†Ø´ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯"
                        ],
                        impact: "Ø³Ø±Ù‚Øª ÙˆØ¬ÙˆÙ‡ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ Ù‚ÛŒÙ…Øª",
                        prevention: "Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Oracle Ù‡Ø§ÛŒ Ù…Ù‚Ø§ÙˆÙ… Ùˆ TWAP"
                    },

                    frontRunning: {
                        title: "Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Ø­Ù…Ù„Ù‡ Front-Running",
                        steps: [
                            "Ù…Ù‡Ø§Ø¬Ù… mempool Ø´Ø¨Ú©Ù‡ Ø±Ø§ Ù…Ø§Ù†ÛŒØªÙˆØ± Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "ØªØ±Ø§Ú©Ù†Ø´ Ø³ÙˆØ¯Ø¢ÙˆØ± Ú©Ø§Ø±Ø¨Ø± Ø¹Ø§Ø¯ÛŒ Ø±Ø§ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "ØªØ±Ø§Ú©Ù†Ø´ Ù…Ø´Ø§Ø¨Ù‡ Ø¨Ø§ gas price Ø¨Ø§Ù„Ø§ØªØ± Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "ØªØ±Ø§Ú©Ù†Ø´ Ù…Ù‡Ø§Ø¬Ù… Ø²ÙˆØ¯ØªØ± Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù‡ Ùˆ Ø³ÙˆØ¯ Ø±Ø§ Ù…ÛŒâ€ŒØ¨Ø±Ø¯",
                            "ØªØ±Ø§Ú©Ù†Ø´ Ú©Ø§Ø±Ø¨Ø± Ø¹Ø§Ø¯ÛŒ Ø¨Ø§ Ù‚ÛŒÙ…Øª Ù†Ø§Ù…Ø·Ù„ÙˆØ¨ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯"
                        ],
                        impact: "Ø³Ø±Ù‚Øª ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ Ùˆ Ø¶Ø±Ø± Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†",
                        prevention: "Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² commit-reveal schemes ÛŒØ§ private mempools"
                    },

                    oracleManipulation: {
                        title: "Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ Oracle",
                        steps: [
                            "Ù…Ù‡Ø§Ø¬Ù… Ù…Ù‚Ø¯Ø§Ø± Ø²ÛŒØ§Ø¯ÛŒ Ø§Ø² ÛŒÚ© Ø·Ø±Ù pool Ø±Ø§ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "Ø§ÛŒÙ† Ú©Ø§Ø± Ù‚ÛŒÙ…Øª Ø±Ø§ Ø¨Ù‡ Ø·ÙˆØ± Ù…ÙˆÙ‚Øª ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒØ¯Ù‡Ø¯",
                            "Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ù‡Ø¯Ù Ù‚ÛŒÙ…Øª Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ Ø´Ø¯Ù‡ Ø±Ø§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù†Ø¯",
                            "Ù…Ù‡Ø§Ø¬Ù… Ø§Ø² Ø§ÛŒÙ† Ù‚ÛŒÙ…Øª ØºÛŒØ±ÙˆØ§Ù‚Ø¹ÛŒ Ø¨Ø±Ø§ÛŒ Ø³ÙˆØ¡Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "Ø³Ù¾Ø³ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ Ø±Ø§ Ù…Ø¹Ú©ÙˆØ³ Ú©Ø±Ø¯Ù‡ Ùˆ Ø³ÙˆØ¯ Ù†Ù‡Ø§ÛŒÛŒ Ø±Ø§ Ù…ÛŒâ€ŒØ¨Ø±Ø¯"
                        ],
                        impact: "Ø³ÙˆØ¡Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ Ø´Ø¯Ù‡",
                        prevention: "Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Oracle Ù‡Ø§ÛŒ Ù…ØªØ¹Ø¯Ø¯ Ùˆ TWAP"
                    },

                    gasLimitDoS: {
                        title: "Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Ø­Ù…Ù„Ù‡ DoS Ø¨Ø§ Ú¯Ø§Ø²",
                        steps: [
                            "Ù…Ù‡Ø§Ø¬Ù… Ø¢Ø±Ø§ÛŒÙ‡â€ŒØ§ÛŒ Ø±Ø§ Ø¨Ø§ ØªØ¹Ø¯Ø§Ø¯ Ø²ÛŒØ§Ø¯ÛŒ Ø¢ÛŒØªÙ… Ù¾Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "ØªØ§Ø¨Ø¹ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±ÙˆÛŒ Ú©Ù„ Ø¢Ø±Ø§ÛŒÙ‡ iterate Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "Ø¨Ø§ Ø§ÙØ²Ø§ÛŒØ´ Ø³Ø§ÛŒØ² Ø¢Ø±Ø§ÛŒÙ‡ØŒ gas Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø¨ÛŒØ´ØªØ± Ù…ÛŒâ€ŒØ´ÙˆØ¯",
                            "Ø¯Ø± Ù†Ù‡Ø§ÛŒØª ØªØ§Ø¨Ø¹ Ø§Ø² Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ú¯Ø§Ø² block ÙØ±Ø§ØªØ± Ù…ÛŒâ€ŒØ±ÙˆØ¯",
                            "ØªØ§Ø¨Ø¹ ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ DoS Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯"
                        ],
                        impact: "ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù† Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯",
                        prevention: "Ù…Ø­Ø¯ÙˆØ¯ÛŒØª ØªØ¹Ø¯Ø§Ø¯ ØªÚ©Ø±Ø§Ø± Ùˆ pagination"
                    },

                    accessControlBypass: {
                        title: "Ø³Ù†Ø§Ø±ÛŒÙˆÛŒ Ø¯ÙˆØ± Ø²Ø¯Ù† Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ",
                        steps: [
                            "Ù…Ù‡Ø§Ø¬Ù… Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ÛŒ Ø¨Ø§ ØªØ§Ø¨Ø¹ fallback Ù…ÛŒâ€ŒØ³Ø§Ø²Ø¯",
                            "Ø§Ø² ØªØ§Ø¨Ø¹ Ø¨Ø¯ÙˆÙ† Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "ÛŒØ§ Ø§Ø² tx.origin Ø¨Ù‡ Ø¬Ø§ÛŒ msg.sender Ø³ÙˆØ¡Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯",
                            "Ú©Ø§Ø±Ø¨Ø± Ø¹Ø§Ø¯ÛŒ Ø±Ø§ ÙØ±ÛŒØ¨ Ø¯Ø§Ø¯Ù‡ ØªØ§ ØªØ±Ø§Ú©Ù†Ø´ Ø§Ù…Ø¶Ø§ Ú©Ù†Ø¯",
                            "Ù…Ù‡Ø§Ø¬Ù… Ø¯Ø³ØªØ±Ø³ÛŒ admin Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù‡ ÛŒØ§ ÙˆØ¬ÙˆÙ‡ Ø±Ø§ Ù…ÛŒâ€ŒØ¯Ø²Ø¯Ø¯"
                        ],
                        impact: "Ú©Ù†ØªØ±Ù„ Ú©Ø§Ù…Ù„ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ ÛŒØ§ Ø³Ø±Ù‚Øª ÙˆØ¬ÙˆÙ‡",
                        prevention: "Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ù‚ÛŒÙ‚ Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ùˆ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² msg.sender"
                    }
                };
            }

            setupEventListeners() {
                const analyzeBtn = document.getElementById('analyzeBtn');
                const codeInput = document.getElementById('solidityCode');

                analyzeBtn.addEventListener('click', () => {
                    this.performAnalysis();
                });

                let timeout;
                codeInput.addEventListener('input', () => {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => {
                        this.showQuickHints();
                    }, 1000);
                });
            }

            async performAnalysis() {
                const code = document.getElementById('solidityCode').value.trim();
                
                if (!code) {
                    this.showError('Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Solidity Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                    return;
                }

                this.showLoading();
                
                setTimeout(() => {
                    const vulnerabilities = this.analyzeCode(code);
                    this.displayResults(vulnerabilities);
                }, 1500);
            }

            analyzeCode(code) {
                const vulnerabilities = [];

                // ØªØ­Ù„ÛŒÙ„ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ
                for (const [key, pattern] of Object.entries(this.patterns)) {
                    const findings = this.detectPattern(code, pattern);
                    if (findings.length > 0) {
                        vulnerabilities.push({
                            id: key,
                            ...pattern,
                            findings,
                            lineNumbers: this.getLineNumbers(code, findings),
                            confidence: this.calculateConfidence(code, pattern),
                            attackScenario: this.attackScenarios[key]
                        });
                    }
                }

                // ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
                vulnerabilities.push(...this.performAdvancedChecks(code));

                // ØªØ­Ù„ÛŒÙ„ Ù…ØªÙ†ÛŒ
                vulnerabilities.push(...this.performContextualAnalysis(code));

                return vulnerabilities.sort((a, b) => 
                    this.getSeverityWeight(b.severity) - this.getSeverityWeight(a.severity)
                );
            }

            detectPattern(code, pattern) {
                const findings = [];
                let hasVulnerability = false;

                for (const regex of pattern.patterns) {
                    const matches = [...code.matchAll(regex)];
                    if (matches.length > 0) {
                        hasVulnerability = true;
                        findings.push(...matches.map(match => ({
                            code: match[0],
                            position: match.index,
                            context: this.getContext(code, match.index, 3)
                        })));
                    }
                }

                let hasMitigation = false;
                for (const antiRegex of pattern.antiPatterns) {
                    if (antiRegex.test(code)) {
                        hasMitigation = true;
                        break;
                    }
                }

                return (hasVulnerability && !hasMitigation) ? findings : [];
            }

            performAdvancedChecks(code) {
                const advancedVulnerabilities = [];

                this.advancedChecks.complexPatterns.forEach(check => {
                    if (check.check(code)) {
                        advancedVulnerabilities.push({
                            id: check.name,
                            severity: check.severity,
                            title: check.title,
                            description: check.description,
                            findings: [{code: 'Advanced pattern detected', position: 0}],
                            lineNumbers: [],
                            impact: ['financial'],
                            gasImpact: 'medium',
                            isAdvanced: true
                        });
                    }
                });

                return advancedVulnerabilities;
            }

            performContextualAnalysis(code) {
                const contextualIssues = [];

                // Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ events
                if (/function\s+\w+.*payable/g.test(code) && !/emit\s+/g.test(code)) {
                    contextualIssues.push({
                        id: 'missing_events',
                        severity: 'low',
                        title: 'Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…ÙÙ‚ÙˆØ¯ Ø¯Ø± ØªÙˆØ§Ø¨Ø¹ Ù…Ù‡Ù…',
                        description: 'ØªÙˆØ§Ø¨Ø¹ Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø¯ÙˆÙ† Ø§Ù†ØªØ´Ø§Ø± Ø±ÙˆÛŒØ¯Ø§Ø¯ Ú©Ù‡ Ø±Ø¯ÛŒØ§Ø¨ÛŒ Ø±Ø§ Ø¯Ø´ÙˆØ§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯',
                        findings: [{code: 'Missing events in payable functions', position: 0}],
                        lineNumbers: [],
                        impact: ['privacy'],
                        gasImpact: 'low'
                    });
                }

                // Ø¨Ø±Ø±Ø³ÛŒ Ù…Ù‚Ø§Ø¯ÛŒØ± magic number
                const magicNumbers = [...code.matchAll(/\b\d{6,}\b/g)];
                if (magicNumbers.length > 0) {
                    contextualIssues.push({
                        id: 'magic_numbers',
                        severity: 'info',
                        title: 'Ø§Ø¹Ø¯Ø§Ø¯ Ø¬Ø§Ø¯ÙˆÛŒÛŒ (Magic Numbers)',
                        description: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§Ø¹Ø¯Ø§Ø¯ Ø¨Ø²Ø±Ú¯ Ø¨Ø¯ÙˆÙ† ØªÙˆØ¶ÛŒØ­ Ú©Ù‡ Ø®ÙˆØ§Ù†Ø§ÛŒÛŒ Ú©Ø¯ Ø±Ø§ Ú©Ø§Ù‡Ø´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯',
                        findings: magicNumbers.map(match => ({
                            code: match[0],
                            position: match.index
                        })),
                        lineNumbers: this.getLineNumbers(code, magicNumbers.map(m => ({position: m.index}))),
                        impact: ['governance'],
                        gasImpact: 'low'
                    });
                }

                // Ø¨Ø±Ø±Ø³ÛŒ pragma floating
                if (/pragma\s+solidity\s+\^/g.test(code)) {
                    contextualIssues.push({
                        id: 'floating_pragma',
                        severity: 'info',
                        title: 'Pragma Ø´Ù†Ø§ÙˆØ±',
                        description: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² pragma Ø´Ù†Ø§ÙˆØ± Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ù…Ø´Ú©Ù„Ø§Øª Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ø´ÙˆØ¯',
                        findings: [{code: 'Floating pragma detected', position: 0}],
                        lineNumbers: [],
                        impact: ['governance'],
                        gasImpact: 'low'
                    });
                }

                // Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ø¯Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² SafeMath Ø¯Ø± Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ
                const hasOldSolidity = /pragma\s+solidity\s+[\^~>=<\s]*0\.[0-7]/g.test(code);
                const hasMathOperations = /[\+\-\*\/]\s*=/g.test(code);
                const hasSafeMath = /SafeMath/g.test(code);
                
                if (hasOldSolidity && hasMathOperations && !hasSafeMath) {
                    contextualIssues.push({
                        id: 'missing_safemath',
                        severity: 'high',
                        title: 'Ø¹Ø¯Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² SafeMath Ø¯Ø± Ù†Ø³Ø®Ù‡ Ù‚Ø¯ÛŒÙ…ÛŒ',
                        description: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¹Ù…Ù„ÛŒØ§Øª Ø±ÛŒØ§Ø¶ÛŒ Ø¨Ø¯ÙˆÙ† SafeMath Ø¯Ø± Solidity < 0.8.0',
                        findings: [{code: 'Missing SafeMath in old Solidity version', position: 0}],
                        lineNumbers: [],
                        impact: ['financial'],
                        gasImpact: 'medium'
                    });
                }

                return contextualIssues;
            }

            getContext(code, position, lines = 2) {
                const codeLines = code.split('\n');
                let currentPos = 0;
                
                for (let i = 0; i < codeLines.length; i++) {
                    if (currentPos <= position && position <= currentPos + codeLines[i].length) {
                        const start = Math.max(0, i - lines);
                        const end = Math.min(codeLines.length - 1, i + lines);
                        return codeLines.slice(start, end + 1)
                            .map((line, idx) => `${start + idx + 1}: ${line}`)
                            .join('\n');
                    }
                    currentPos += codeLines[i].length + 1;
                }
                
                return '';
            }

            getLineNumbers(code, findings) {
                const lines = code.split('\n');
                const lineNumbers = [];
                
                findings.forEach(finding => {
                    let currentPos = 0;
                    for (let i = 0; i < lines.length; i++) {
                        if (currentPos <= finding.position && finding.position <= currentPos + lines[i].length) {
                            lineNumbers.push(i + 1);
                            break;
                        }
                        currentPos += lines[i].length + 1;
                    }
                });
                
                return [...new Set(lineNumbers)].sort((a, b) => a - b);
            }

            calculateConfidence(code, pattern) {
                let confidence = 75;
                
                if (pattern.patterns.length > 3) confidence += 10;
                if (pattern.antiPatterns.length > 2) confidence += 5;
                if (code.includes('pragma solidity ^0.8')) confidence += 5;
                if (code.includes('@openzeppelin')) confidence += 10;
                
                return Math.min(95, Math.max(65, confidence));
            }

            getSeverityWeight(severity) {
                const weights = { critical: 5, high: 4, medium: 3, low: 2, info: 1 };
                return weights[severity] || 0;
            }

            showLoading() {
                const btn = document.getElementById('analyzeBtn');
                const btnText = document.getElementById('btnText');
                const results = document.getElementById('results');

                btn.disabled = true;
                btnText.innerHTML = 'ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„ Ø¹Ù…Ù‚ÛŒ...';
                
                results.innerHTML = `
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø§Ù…Ù†ÛŒØª Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…...</p>
                        <p style="font-size: 0.9em; color: var(--text-muted); margin-top: 10px;">
                            Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø­Ù…Ù„Ù‡ØŒ ØªØ­Ù„ÛŒÙ„ Ù…ØªÙ†ØŒ Ùˆ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾Ù†Ù‡Ø§Ù†
                        </p>
                    </div>
                `;
            }

            showError(message) {
                const results = document.getElementById('results');
                results.innerHTML = `
                    <div class="no-results">
                        âš ï¸ ${message}
                    </div>
                `;
            }

            showQuickHints() {
                const code = document.getElementById('solidityCode').value;
                if (code.length < 50) return;

                console.log('ğŸ” Quick scan in progress...');
            }

            displayResults(vulnerabilities) {
                const btn = document.getElementById('analyzeBtn');
                const btnText = document.getElementById('btnText');
                const results = document.getElementById('results');

                btn.disabled = false;
                btnText.innerHTML = 'ğŸ” ØªØ­Ù„ÛŒÙ„ Ø§Ù…Ù†ÛŒØªÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡';

                if (vulnerabilities.length === 0) {
                    results.innerHTML = `
                        <div class="no-results success">
                            <div style="font-size: 4rem; margin-bottom: 25px;">âœ…</div>
                            <h3>Ù‡ÛŒÚ† Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ Ø§Ù…Ù†ÛŒØªÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯!</h3>
                            <p>Ú©Ø¯ Ø´Ù…Ø§ Ø§Ø² Ù†Ø¸Ø± Ø§Ù…Ù†ÛŒØªÛŒ Ø¨Ø³ÛŒØ§Ø± Ù…Ù†Ø§Ø³Ø¨ Ø§Ø³Øª Ùˆ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø§Ù…Ù† Ø±Ø§ Ø±Ø¹Ø§ÛŒØª Ú©Ø±Ø¯Ù‡ Ø§Ø³Øª.</p>
                        </div>
                    `;
                    return;
                }

                const stats = this.calculateStatistics(vulnerabilities);
                let html = this.generateStatsHTML(stats);
                
                vulnerabilities.forEach((vuln, index) => {
                    html += this.generateVulnerabilityHTML(vuln, index);
                });

                results.innerHTML = html;
                this.attachToggleListeners();
            }

            calculateStatistics(vulnerabilities) {
                return {
                    total: vulnerabilities.length,
                    critical: vulnerabilities.filter(v => v.severity === 'critical').length,
                    high: vulnerabilities.filter(v => v.severity === 'high').length,
                    medium: vulnerabilities.filter(v => v.severity === 'medium').length,
                    low: vulnerabilities.filter(v => v.severity === 'low').length,
                    info: vulnerabilities.filter(v => v.severity === 'info').length,
                    financial: vulnerabilities.filter(v => v.impact && v.impact.includes('financial')).length,
                    gas: vulnerabilities.filter(v => v.gasImpact === 'high' || v.gasImpact === 'critical').length
                };
            }

            generateStatsHTML(stats) {
                return `
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number">${stats.total}</div>
                            <div class="stat-label">Ú©Ù„ Ù…Ø³Ø§Ø¦Ù„</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: var(--danger);">${stats.critical}</div>
                            <div class="stat-label">Ø¨Ø­Ø±Ø§Ù†ÛŒ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: #f97316;">${stats.high}</div>
                            <div class="stat-label">Ø¨Ø§Ù„Ø§</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: var(--warning);">${stats.medium}</div>
                            <div class="stat-label">Ù…ØªÙˆØ³Ø·</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: var(--success);">${stats.low + stats.info}</div>
                            <div class="stat-label">Ù¾Ø§ÛŒÛŒÙ†</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: var(--danger);">${stats.financial}</div>
                            <div class="stat-label">Ù…Ø§Ù„ÛŒ</div>
                        </div>
                    </div>
                `;
            }

            generateVulnerabilityHTML(vuln, index) {
                const recommendations = this.getRecommendations(vuln.id);
                const codeExample = this.getSecureCodeExample(vuln.id);
                
                return `
                    <div class="vulnerability-card severity-${vuln.severity}">
                        <div class="vulnerability-header" onclick="toggleVulnerability(${index})">
                            <div>
                                <div class="vulnerability-title">${vuln.title}</div>
                                <div class="vulnerability-meta">
                                    ${vuln.findings.length} Ù…ÙˆØ±Ø¯ ÛŒØ§ÙØª Ø´Ø¯
                                    ${vuln.lineNumbers.length > 0 ? `â€¢ Ø®Ø·ÙˆØ·: ${vuln.lineNumbers.slice(0, 5).join(', ')}` : ''}
                                    ${vuln.confidence ? `â€¢ Ø§Ø¹ØªÙ…Ø§Ø¯: ${vuln.confidence}%` : ''}
                                    ${vuln.cwe ? `â€¢ ${vuln.cwe}` : ''}
                                    <br>
                                    ${vuln.impact ? vuln.impact.map(impact => 
                                        `<span class="impact-badge impact-${impact}">${this.getImpactLabel(impact)}</span>`
                                    ).join('') : ''}
                                </div>
                            </div>
                            <div>
                                <span class="severity-badge severity-${vuln.severity}">${this.getSeverityLabel(vuln.severity)}</span>
                                <span class="expand-icon" id="icon-${index}">â–¼</span>
                            </div>
                        </div>
                        <div class="vulnerability-details" id="details-${index}">
                            <p><strong>ğŸ“‹ ØªÙˆØ¶ÛŒØ­Ø§Øª:</strong> ${vuln.description}</p>
                            
                            ${vuln.gasImpact ? `
                                <p><strong>â›½ ØªØ£Ø«ÛŒØ± Ø¨Ø± Ú¯Ø§Ø²:</strong> <span class="severity-badge severity-${vuln.gasImpact}">${vuln.gasImpact}</span></p>
                            ` : ''}
                            
                            <h4 class="section-title">ğŸ¯ Ú©Ø¯Ù‡Ø§ÛŒ Ù…Ø´Ú©Ù„â€ŒØ¯Ø§Ø±:</h4>
                            ${vuln.findings.slice(0, 3).map(finding => 
                                `<div class="code-block">${this.escapeHtml(finding.code)}</div>
                                ${finding.context ? `<p style="font-size: 0.9em; color: var(--text-muted); margin: 10px 0;">Ù…ØªÙ† Ø§Ø·Ø±Ø§Ù:</p>
                                <div class="code-block" style="font-size: 0.85em;">${this.escapeHtml(finding.context)}</div>` : ''}`
                            ).join('')}
                            
                            ${vuln.attackScenario ? `
                                <div class="attack-scenario">
                                    <h4>ğŸš¨ ${vuln.attackScenario.title}</h4>
                                    <div class="attack-steps">
                                        ${vuln.attackScenario.steps.map((step, i) => 
                                            `<div class="attack-step">
                                                <strong>Ú¯Ø§Ù… ${i + 1}:</strong> ${step}
                                            </div>`
                                        ).join('')}
                                    </div>
                                    <p><strong>ØªØ£Ø«ÛŒØ± Ø­Ù…Ù„Ù‡:</strong> ${vuln.attackScenario.impact}</p>
                                </div>
                            ` : ''}
                            
                            ${recommendations ? `
                                <div class="recommendation">
                                    <h4>ğŸ’¡ Ø±Ø§Ù‡â€ŒØ­Ù„ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:</h4>
                                    <p>${recommendations}</p>
                                </div>
                            ` : ''}
                            
                            ${codeExample ? `
                                <h4 class="section-title">âœ… Ù…Ø«Ø§Ù„ Ú©Ø¯ Ø§Ù…Ù†:</h4>
                                <div class="code-block">${codeExample}</div>
                            ` : ''}
                            
                            ${vuln.isAdvanced ? `
                                <div class="advanced-analysis">
                                    <h4>ğŸ§  ØªØ­Ù„ÛŒÙ„ Ù‡ÙˆØ´Ù…Ù†Ø¯:</h4>
                                    <p>Ø§ÛŒÙ† Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ ØªÙˆØ³Ø· Ø³ÛŒØ³ØªÙ… ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ø¯Ù‡ Ùˆ Ù…Ù…Ú©Ù† Ø§Ø³Øª ØªÙˆØ³Ø· Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù…Ø¹Ù…ÙˆÙ„ÛŒ Ù†Ø§Ø¯ÛŒØ¯Ù‡ Ú¯Ø±ÙØªÙ‡ Ø´ÙˆØ¯.</p>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }

            getSeverityLabel(severity) {
                const labels = {
                    critical: 'Ø¨Ø­Ø±Ø§Ù†ÛŒ',
                    high: 'Ø¨Ø§Ù„Ø§',
                    medium: 'Ù…ØªÙˆØ³Ø·',
                    low: 'Ù¾Ø§ÛŒÛŒÙ†',
                    info: 'Ø§Ø·Ù„Ø§Ø¹Ø§ØªÛŒ'
                };
                return labels[severity] || severity;
            }

            getImpactLabel(impact) {
                const labels = {
                    financial: 'Ù…Ø§Ù„ÛŒ',
                    dos: 'DoS',
                    privacy: 'Ø­Ø±ÛŒÙ… Ø®ØµÙˆØµÛŒ',
                    governance: 'Ø­Ø§Ú©Ù…ÛŒØª'
                };
                return labels[impact] || impact;
            }

            getRecommendations(vulnId) {
                const recommendations = {
                    reentrancy: 'Ø§Ø² Ø§Ù„Ú¯ÙˆÛŒ Checks-Effects-Interactions Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯: Ø§Ø¨ØªØ¯Ø§ Ø´Ø±Ø§ÛŒØ· Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯ØŒ Ø³Ù¾Ø³ ÙˆØ¶Ø¹ÛŒØª Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒØ¯ØŒ Ùˆ Ø¯Ø± Ù†Ù‡Ø§ÛŒØª Ø¨Ø§ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯Ù‡Ø§ÛŒ Ø®Ø§Ø±Ø¬ÛŒ ØªØ¹Ø§Ù…Ù„ Ú©Ù†ÛŒØ¯. Ø§Ø² OpenZeppelin ReentrancyGuard Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ ØªØ§ Ø§Ø² Ø­Ù…Ù„Ø§Øª reentrancy Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø´ÙˆØ¯.',
                    
                    flashLoanAttack: 'Ø§Ø² Oracle Ù‡Ø§ÛŒ Ù…Ù‚Ø§ÙˆÙ… Ù…Ø§Ù†Ù†Ø¯ Chainlink ÛŒØ§ TWAP (Time-Weighted Average Price) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. Ù‡Ø±Ú¯Ø² ØªÙ†Ù‡Ø§ Ø§Ø² ÛŒÚ© Ù…Ù†Ø¨Ø¹ Ù‚ÛŒÙ…Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒØ¯. Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§ÛŒÛŒ Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ±Ø§Øª Ù‚ÛŒÙ…Øª Ù†Ø§Ú¯Ù‡Ø§Ù†ÛŒ Ø¯Ø± Ù†Ø¸Ø± Ø¨Ú¯ÛŒØ±ÛŒØ¯.',
                    
                    frontRunning: 'Ø§Ø² Ø§Ù„Ú¯ÙˆÛŒ commit-reveal Ø¨Ø±Ø§ÛŒ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ø­Ø³Ø§Ø³ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. Ø­Ø¯ Ù…Ø¬Ø§Ø² slippage ØªØ¹ÛŒÛŒÙ† Ú©Ù†ÛŒØ¯ Ùˆ Ø§Ø² private mempools ÛŒØ§ Meta-transactions Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§ÙØ¸Øª Ø§Ø² Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.',
                    
                    accessControlBypass: 'Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø² modifier Ù‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. OpenZeppelin AccessControl ÛŒØ§ Ownable Ø±Ø§ Ø¨Ù‡ Ú©Ø§Ø± Ø¨Ú¯ÛŒØ±ÛŒØ¯. Ù‡Ø±Ú¯Ø² ØªÙˆØ§Ø¨Ø¹ Ø­Ø³Ø§Ø³ Ø±Ø§ Ø¨Ø¯ÙˆÙ† Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ public Ù†Ú¯Ø°Ø§Ø±ÛŒØ¯. Ø§Ø² msg.sender Ø¨Ù‡ Ø¬Ø§ÛŒ tx.origin Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.',
                    
                    integerOverflow: 'Ø¨Ø±Ø§ÛŒ Solidity 0.8.0+ØŒ Ø¨Ø±Ø±Ø³ÛŒâ€ŒÙ‡Ø§ÛŒ overflow Ø®ÙˆØ¯Ú©Ø§Ø± ÙØ¹Ø§Ù„ Ù‡Ø³ØªÙ†Ø¯. Ø¨Ø±Ø§ÛŒ Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒâ€ŒØªØ±ØŒ Ø­ØªÙ…Ø§Ù‹ Ø§Ø² OpenZeppelin SafeMath Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. Ø¯Ø± ØµÙˆØ±Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² uncheckedØŒ Ø¨Ø³ÛŒØ§Ø± Ù…Ø­ØªØ§Ø· Ø¨Ø§Ø´ÛŒØ¯.',
                    
                    oracleManipulation: 'Ø§Ø² Ú†Ù†Ø¯ÛŒÙ† Oracle Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ Ùˆ Ù†ØªØ§ÛŒØ¬ Ø±Ø§ Ø¨Ø§ Ù‡Ù… Ù…Ù‚Ø§ÛŒØ³Ù‡ Ú©Ù†ÛŒØ¯. Ø§Ø² TWAP Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ Ù‚ÛŒÙ…Øª Ú©ÙˆØªØ§Ù‡ Ù…Ø¯Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. Ø­Ø¯ Ø¢Ø³ØªØ§Ù†Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ±Ø§Øª Ù‚ÛŒÙ…Øª ØºÛŒØ±Ø¹Ø§Ø¯ÛŒ ØªØ¹Ø±ÛŒÙ Ú©Ù†ÛŒØ¯.',
                    
                    timestampManipulation: 'Ø§Ø² block.timestamp Ø¨Ø±Ø§ÛŒ Ù…Ù†Ø·Ù‚ Ø­Ø³Ø§Ø³ Ø²Ù…Ø§Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒØ¯. tolerance Ø²Ù…Ø§Ù†ÛŒ (Ù…Ø«Ù„Ø§Ù‹ Â±15 Ø«Ø§Ù†ÛŒÙ‡) Ø¯Ø± Ù†Ø¸Ø± Ø¨Ú¯ÛŒØ±ÛŒØ¯. Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø¯Ù‡Ø§ÛŒ Ø­Ø³Ø§Ø³â€ŒØªØ± Ø§Ø² Oracle Ù‡Ø§ÛŒ Ø²Ù…Ø§Ù† Ø®Ø§Ø±Ø¬ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.',
                    
                    txOrigin: 'Ù‡Ø±Ú¯Ø² Ø§Ø² tx.origin Ø¨Ø±Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒØ¯ Ø²ÛŒØ±Ø§ Ù‚Ø§Ø¨Ù„ ÙØ±ÛŒØ¨ Ø§Ø³Øª. Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø² msg.sender Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ Ú©Ù‡ Ù†Ø´Ø§Ù†â€ŒØ¯Ù‡Ù†Ø¯Ù‡ ÙØ±Ø§Ø®ÙˆØ§Ù†Ù†Ø¯Ù‡ Ù…Ø³ØªÙ‚ÛŒÙ… Ø§Ø³Øª.',
                    
                    weakRandomness: 'Ø§Ø² Oracle Ù‡Ø§ÛŒ ØªØµØ§Ø¯Ù Ø§Ù…Ù† Ù…Ø§Ù†Ù†Ø¯ Chainlink VRF Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. Ù‡Ø±Ú¯Ø² Ø§Ø² block.timestampØŒ block.difficultyØŒ ÛŒØ§ block.number Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¹Ø¯Ø¯ ØªØµØ§Ø¯ÙÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒØ¯ Ø²ÛŒØ±Ø§ Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ Ù‡Ø³ØªÙ†Ø¯.',
                    
                    dangerousDelegatecall: 'delegatecall Ø±Ø§ ØªÙ†Ù‡Ø§ Ø§Ø² Ø¢Ø¯Ø±Ø³â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ø§Ø¹ØªÙ…Ø§Ø¯ Ùˆ Ø¨Ø§ Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ø³Ø®Øªâ€ŒÚ¯ÛŒØ±Ø§Ù†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. Ù‡Ù…ÛŒØ´Ù‡ Ù†ØªÛŒØ¬Ù‡ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯. Ø¨Ø±Ø§ÛŒ proxy contracts Ø§Ø² Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ OpenZeppelin Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.',
                    
                    gasLimitDoS: 'Ø§Ø² Ø­Ù„Ù‚Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ú©Ù†ÛŒØ¯. Ù…Ø­Ø¯ÙˆØ¯ÛŒØª ØªØ¹Ø¯Ø§Ø¯ ØªÚ©Ø±Ø§Ø± Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯. Ø§Ø² Ø§Ù„Ú¯ÙˆÛŒ pagination Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. Ø§Ø² pull over push pattern Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.',
                    
                    uncheckedExternalCalls: 'Ù‡Ù…ÛŒØ´Ù‡ Ù†ØªÛŒØ¬Ù‡ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒâ€ŒÙ‡Ø§ÛŒ Ø®Ø§Ø±Ø¬ÛŒ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯. Ø§Ø² require() Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. Ø§Ø² Ø§Ù„Ú¯ÙˆÛŒ withdrawal Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø§ØªØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.',
                    
                    sandwich_attack_vulnerability: 'Ø­Ø¯ Ù…Ø¬Ø§Ø² slippage ØªØ¹ÛŒÛŒÙ† Ú©Ù†ÛŒØ¯ØŒ deadline Ø¨Ø±Ø§ÛŒ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯ØŒ Ùˆ Ø§Ø² AMM Ù‡Ø§ÛŒÛŒ Ø¨Ø§ Ù…Ø­Ø§ÙØ¸Øª MEV Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.',
                    
                    governance_attack: 'Timelock Ø¨Ø±Ø§ÛŒ ØªØµÙ…ÛŒÙ…Ø§Øª Ø­Ø§Ú©Ù…ÛŒØªÛŒ Ø§Ø¬Ø¨Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯ØŒ Ø­Ø¯ Ø¢Ø³ØªØ§Ù†Ù‡ Ø¨Ø§Ù„Ø§ÛŒÛŒ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª ØªØ¹ÛŒÛŒÙ† Ú©Ù†ÛŒØ¯ØŒ Ùˆ Ø§Ø² multi-sig Ø¨Ø±Ø§ÛŒ ØªØµÙ…ÛŒÙ…Ø§Øª Ù…Ù‡Ù… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.',
                    
                    state_bloating: 'Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø§Ù†Ø¯Ø§Ø²Ù‡ Ø¢Ø±Ø§ÛŒÙ‡â€ŒÙ‡Ø§ ØªØ¹ÛŒÛŒÙ† Ú©Ù†ÛŒØ¯ØŒ Ø§Ø² mapping Ù‡Ø§ Ø¨Ù‡ Ø¬Ø§ÛŒ Ø¢Ø±Ø§ÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ØŒ Ùˆ mechanism Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ù†ÛŒØ¯.',
                    
                    missing_events: 'Ø¨Ø±Ø§ÛŒ ØªÙ…Ø§Ù… ØªØºÛŒÛŒØ±Ø§Øª Ù…Ù‡Ù… ÙˆØ¶Ø¹ÛŒØªØŒ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ù†Ø§Ø³Ø¨ ØªØ¹Ø±ÛŒÙ Ú©Ù†ÛŒØ¯ ØªØ§ Ø±Ø¯ÛŒØ§Ø¨ÛŒ Ùˆ monitoring Ø¢Ø³Ø§Ù† Ø´ÙˆØ¯.',
                    
                    magic_numbers: 'ØªÙ…Ø§Ù… Ø§Ø¹Ø¯Ø§Ø¯ Ø«Ø§Ø¨Øª Ø±Ø§ Ø¨Ø§ Ù†Ø§Ù…â€ŒÙ‡Ø§ÛŒ meaningful Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† constant ØªØ¹Ø±ÛŒÙ Ú©Ù†ÛŒØ¯.',
                    
                    floating_pragma: 'Ù†Ø³Ø®Ù‡ Ø¯Ù‚ÛŒÙ‚ Solidity Ø±Ø§ Ù…Ø´Ø®Øµ Ú©Ù†ÛŒØ¯ ØªØ§ Ø§Ø² Ù…Ø´Ú©Ù„Ø§Øª Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø´ÙˆØ¯.',
                    
                    missing_safemath: 'Ø¯Ø± Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ Ø§Ø² 0.8.0ØŒ Ø­ØªÙ…Ø§Ù‹ Ø§Ø² OpenZeppelin SafeMath Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.'
                };
                
                return recommendations[vulnId] || 'Ú©Ø¯ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø±Ø¯Ù‡ Ùˆ Ø§Ø² best practices Ø§Ù…Ù†ÛŒØªÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.';
            }

            getSecureCodeExample(vulnId) {
                const examples = {
                    reentrancy: `// Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ReentrancyGuard Ùˆ Ø§Ù„Ú¯ÙˆÛŒ CEI
import "@openzeppelin/contracts/security/ReentrancyGuard.sol";

contract SafeContract is ReentrancyGuard {
    mapping(address => uint256) public balances;
    
    function withdraw() external nonReentrant {
        uint256 amount = balances[msg.sender];
        require(amount > 0, "No funds");
        
        // Effects: ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ù‚Ø¨Ù„ Ø§Ø² ØªØ¹Ø§Ù…Ù„ Ø®Ø§Ø±Ø¬ÛŒ
        balances[msg.sender] = 0;
        
        // Interactions: ØªØ¹Ø§Ù…Ù„ Ø®Ø§Ø±Ø¬ÛŒ Ø¯Ø± Ø¢Ø®Ø±
        (bool success, ) = payable(msg.sender).call{value: amount}("");
        require(success, "Transfer failed");
    }
}`,
                    
                    uncheckedExternalCalls: `// Ø¨Ø±Ø±Ø³ÛŒ Ù†ØªÛŒØ¬Ù‡ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒâ€ŒÙ‡Ø§
function safeTransfer(address to, uint256 amount) external {
    // Ø±ÙˆØ´ 1: Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø§ require
    (bool success, ) = payable(to).call{value: amount}("");
    require(success, "Transfer failed");
    
    // Ø±ÙˆØ´ 2: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² withdrawal pattern
    pendingWithdrawals[to] += amount;
}

function withdraw() external {
    uint256 amount = pendingWithdrawals[msg.sender];
    require(amount > 0, "No pending withdrawal");
    
    pendingWithdrawals[msg.sender] = 0;
    payable(msg.sender).transfer(amount);
}`,
                    
                    accessControlBypass: `// Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ ØµØ­ÛŒØ­
import "@openzeppelin/contracts/access/Ownable.sol";

contract SecureContract is Ownable {
    modifier onlyAuthorized() {
        require(msg.sender == owner() || authorizedUsers[msg.sender], "Unauthorized");
        _;
    }
    
    function sensitiveFunction() external onlyAuthorized {
        // ØªÙ†Ù‡Ø§ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù…Ø¬Ø§Ø² Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ø±Ø§ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ú©Ù†Ù†Ø¯
        // Ø§Ø² msg.sender Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ØŒ Ù†Ù‡ tx.origin
    }
}`,
                    
                    oracleManipulation: `// Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Oracle Ø§Ù…Ù†
import "@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol";

contract PriceConsumer {
    AggregatorV3Interface internal priceFeed;
    uint256 private constant PRICE_TOLERANCE = 5; // 5% tolerance
    
    constructor() {
        priceFeed = AggregatorV3Interface(0x...); // Chainlink ETH/USD
    }
    
    function getSecurePrice() public view returns (int256) {
        (
            uint80 roundID,
            int256 price,
            uint256 startedAt,
            uint256 timeStamp,
            uint80 answeredInRound
        ) = priceFeed.latestRoundData();
        
        require(timeStamp > 0, "Round not complete");
        require(block.timestamp - timeStamp < 3600, "Price too old");
        
        return price;
    }
}`,
                    
                    gasLimitDoS: `// Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² DoS Ø¨Ø§ Ú¯Ø§Ø²
contract SafeIteration {
    uint256 public constant MAX_ITERATIONS = 50;
    uint256[] private items;
    
    function processBatch(uint256 startIndex) external {
        uint256 endIndex = startIndex + MAX_ITERATIONS;
        if (endIndex > items.length) {
            endIndex = items.length;
        }
        
        for (uint256 i = startIndex; i < endIndex; i++) {
            // Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¢ÛŒØªÙ…
            processItem(items[i]);
        }
    }
    
    // ÛŒØ§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² pull pattern
    mapping(address => uint256) public rewards;
    
    function claimReward() external {
        uint256 reward = rewards[msg.sender];
        require(reward > 0, "No reward");
        
        rewards[msg.sender] = 0;
        payable(msg.sender).transfer(reward);
    }
}`
                };
                
                return examples[vulnId] || null;
            }

            attachToggleListeners() {
                // Event listeners are attached via onclick in HTML
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        // Global functions for HTML onclick events
        function toggleVulnerability(index) {
            const details = document.getElementById(`details-${index}`);
            const icon = document.getElementById(`icon-${index}`);
            
            if (details.classList.contains('active')) {
                details.classList.remove('active');
                icon.classList.remove('rotated');
            } else {
                details.classList.add('active');
                icon.classList.add('rotated');
            }
        }

        // Initialize the analyzer
        document.addEventListener('DOMContentLoaded', () => {
            new UltimateSecurityAnalyzer();
        });
    </script>
</body>
</html>
