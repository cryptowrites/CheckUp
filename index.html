<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solidity Security Analyzer Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --danger: #dc2626;
            --warning: #f59e0b;
            --success: #059669;
            --info: #0891b2;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --shadow: rgba(0, 0, 0, 0.1);
            --shadow-lg: rgba(0, 0, 0, 0.15);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--gray-50) 0%, #ffffff 100%);
            color: var(--gray-800);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 60px 20px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 4px 20px var(--shadow);
        }
        
        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 16px;
        }
        
        .header p {
            font-size: 1.1rem;
            color: var(--gray-600);
            max-width: 600px;
            margin: 0 auto;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: start;
        }
        
        .input-panel, .results-panel {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px var(--shadow);
        }
        
        .panel-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .code-textarea {
            width: 100%;
            height: 400px;
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            padding: 20px;
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
            font-size: 14px;
            line-height: 1.5;
            background: var(--gray-50);
            color: var(--gray-800);
            resize: vertical;
            transition: border-color 0.3s ease;
        }
        
        .code-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .analyze-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .analyze-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(37, 99, 235, 0.3);
        }
        
        .analyze-btn:disabled {
            background: var(--gray-300);
            cursor: not-allowed;
            transform: none;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: var(--gray-50);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            transition: transform 0.2s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.875rem;
            color: var(--gray-600);
        }
        
        .vulnerability-card {
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            margin-bottom: 16px;
            overflow: hidden;
            background: white;
        }
        
        .vulnerability-header {
            padding: 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s ease;
        }
        
        .vulnerability-header:hover {
            background: var(--gray-50);
        }
        
        .severity-critical .vulnerability-header { border-right: 4px solid var(--danger); }
        .severity-high .vulnerability-header { border-right: 4px solid #ea580c; }
        .severity-medium .vulnerability-header { border-right: 4px solid var(--warning); }
        .severity-low .vulnerability-header { border-right: 4px solid var(--success); }
        .severity-info .vulnerability-header { border-right: 4px solid var(--info); }
        
        .vulnerability-title {
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 5px;
        }
        
        .vulnerability-meta {
            font-size: 0.875rem;
            color: var(--gray-600);
        }
        
        .vulnerability-details {
            padding: 0 20px 20px;
            display: none;
            animation: slideDown 0.3s ease;
        }
        
        .vulnerability-details.active {
            display: block;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .code-block {
            background: var(--gray-800);
            color: #e5e7eb;
            padding: 16px;
            border-radius: 8px;
            font-family: 'SF Mono', monospace;
            font-size: 14px;
            margin: 15px 0;
            overflow-x: auto;
        }
        
        .recommendation {
            background: #ecfdf5;
            border: 1px solid #a7f3d0;
            border-radius: 8px;
            padding: 16px;
            margin: 15px 0;
        }
        
        .recommendation h4 {
            color: var(--success);
            margin-bottom: 8px;
        }
        
        .loading {
            text-align: center;
            padding: 60px 20px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--gray-200);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray-600);
        }
        
        .no-results.success {
            color: var(--success);
        }
        
        .expand-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
            color: var(--gray-600);
        }
        
        .expand-icon.rotated {
            transform: rotate(180deg);
        }
        
        .severity-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .severity-critical { background: #fef2f2; color: var(--danger); }
        .severity-high { background: #fff7ed; color: #ea580c; }
        .severity-medium { background: #fffbeb; color: var(--warning); }
        .severity-low { background: #f0fdf4; color: var(--success); }
        .severity-info { background: #f0f9ff; color: var(--info); }
        
        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ğŸ›¡ï¸ Solidity Security Pro</h1>
            <p>ØªØ­Ù„ÛŒÙ„Ú¯Ø± Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ùˆ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø§Ù…Ù†ÛŒØª Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯Ù‡Ø§ÛŒ Solidity Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù„Ø§ØªØ± Ø§Ø² Slither</p>
        </header>
        
        <div class="main-grid">
            <div class="input-panel">
                <h2 class="panel-title">
                    ğŸ“ Ú©Ø¯ Solidity
                </h2>
                <textarea 
                    id="solidityCode" 
                    class="code-textarea" 
                    placeholder="// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract MyContract {
    address public owner;
    mapping(address => uint256) public balances;
    
    constructor() {
        owner = msg.sender;
    }
    
    function withdraw() public {
        uint256 amount = balances[msg.sender];
        balances[msg.sender] = 0;
        payable(msg.sender).transfer(amount);
    }
}">
                </textarea>
                <button id="analyzeBtn" class="analyze-btn">
                    <span id="btnText">ğŸ” ØªØ­Ù„ÛŒÙ„ Ø§Ù…Ù†ÛŒØªÛŒ</span>
                </button>
            </div>
            
            <div class="results-panel">
                <h2 class="panel-title">
                    ğŸ“Š Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„
                </h2>
                <div id="results">
                    <div class="no-results">
                        Ú©Ø¯ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¯Ú©Ù…Ù‡ ØªØ­Ù„ÛŒÙ„ Ø±Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class AdvancedSolidityAnalyzer {
            constructor() {
                this.patterns = this.initializePatterns();
                this.gasAnalysis = this.initializeGasPatterns();
                this.setupEventListeners();
            }

            initializePatterns() {
                return {
                    reentrancy: {
                        patterns: [
                            /\.call\s*\{[^}]*value[^}]*\}[^;]*;/g,
                            /\.transfer\s*\([^)]+\)[^;]*;\s*(?!.*balances\[[^\]]+\]\s*=\s*0)/g,
                            /payable\([^)]+\)\.call/g,
                            /(address\([^)]+\)|payable\([^)]+\))\.call\{value:/g
                        ],
                        antiPatterns: [
                            /nonReentrant/gi,
                            /ReentrancyGuard/gi,
                            /require\s*\(\s*!locked/gi,
                            /locked\s*=\s*true/g,
                            /balances\[[^\]]+\]\s*=\s*0.*\.call/gs
                        ],
                        severity: 'critical',
                        title: 'Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ Reentrancy',
                        description: 'Ø§Ù…Ú©Ø§Ù† Ø­Ù…Ù„Ù‡ Reentrancy ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯ - Ù…Ù‡Ø§Ø¬Ù… Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ ØªØ§Ø¨Ø¹ Ø±Ø§ Ù‚Ø¨Ù„ Ø§Ø² Ø§ØªÙ…Ø§Ù… Ø§Ø¬Ø±Ø§ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ú©Ù†Ø¯'
                    },

                    uncheckedTransfer: {
                        patterns: [
                            /\.transfer\s*\([^)]+\)\s*;/g,
                            /\.send\s*\([^)]+\)\s*;/g,
                            /\.call\s*\{[^}]*\}\s*\([^)]*\)\s*;/g
                        ],
                        antiPatterns: [
                            /require\s*\([^)]*\.call[^)]*\)/g,
                            /require\s*\([^)]*\.send[^)]*\)/g,
                            /if\s*\([^)]*\.call[^)]*success[^)]*\)/g,
                            /\(bool\s+success[^)]*\)\s*=.*\.call/g
                        ],
                        severity: 'high',
                        title: 'Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ø¯ÙˆÙ† Ø¨Ø±Ø±Ø³ÛŒ Ù†ØªÛŒØ¬Ù‡',
                        description: 'Ø§Ù†ØªÙ‚Ø§Ù„ Ø§ØªØ± ÛŒØ§ ØªÙˆÚ©Ù† Ø¨Ø¯ÙˆÙ† Ø¨Ø±Ø±Ø³ÛŒ Ù…ÙˆÙÙ‚ÛŒØª Ø¹Ù…Ù„ÛŒØ§Øª Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ø§Ø² Ø¯Ø³Øª Ø±ÙØªÙ† ÙˆØ¬ÙˆÙ‡ Ø´ÙˆØ¯'
                    },

                    accessControl: {
                        patterns: [
                            /function\s+\w+[^{]*public[^{]*payable[^{]*\{/g,
                            /function\s+\w+[^{]*external[^{]*payable[^{]*\{/g,
                            /selfdestruct\s*\(/g,
                            /suicide\s*\(/g
                        ],
                        antiPatterns: [
                            /onlyOwner/g,
                            /require\s*\(\s*msg\.sender\s*==\s*owner/g,
                            /modifier\s+only\w+/g,
                            /hasRole\s*\(/g,
                            /_checkOwner\s*\(/g
                        ],
                        severity: 'critical',
                        title: 'Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ù†Ø§Ú©Ø§ÙÛŒ',
                        description: 'ØªÙˆØ§Ø¨Ø¹ Ø­Ø³Ø§Ø³ Ø¨Ø¯ÙˆÙ† Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ù†Ø§Ø³Ø¨ Ú©Ù‡ Ø§Ø¬Ø§Ø²Ù‡ Ø¯Ø³ØªØ±Ø³ÛŒ ØºÛŒØ±Ù…Ø¬Ø§Ø² Ø¨Ù‡ Ù‡Ø± Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø±Ø§ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯'
                    },

                    integerOverflow: {
                        patterns: [
                            /\+\+\w+|--\w+|\w\+\+|\w--|[\w\[\]\.]+\s*[\+\-\*\/]\s*=\s*\w+/g,
                            /unchecked\s*\{[^}]*[\+\-\*\/][^}]*\}/gs
                        ],
                        antiPatterns: [
                            /pragma\s+solidity\s+[\^~>=<\s]*0\.8/g,
                            /SafeMath/g,
                            /require\s*\([^)]*overflow[^)]*\)/gi,
                            /Math\.add|Math\.sub|Math\.mul/g
                        ],
                        severity: 'medium',
                        title: 'Ø§Ø­ØªÙ…Ø§Ù„ Integer Overflow/Underflow',
                        description: 'Ø¹Ù…Ù„ÛŒØ§Øª Ø±ÛŒØ§Ø¶ÛŒ Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ overflow ÛŒØ§ underflow Ø´ÙˆØ¯ØŒ Ù…Ø®ØµÙˆØµØ§Ù‹ Ø¯Ø± Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ Solidity'
                    },

                    timestampManipulation: {
                        patterns: [
                            /block\.timestamp\s*[<>=!]+\s*\w+/g,
                            /now\s*[<>=!]+\s*\w+/g,
                            /require\s*\([^)]*block\.timestamp[^)]*\)/g,
                            /if\s*\([^)]*block\.timestamp[^)]*\)/g
                        ],
                        antiPatterns: [
                            /block\.number/g,
                            /oracle/gi,
                            /chainlink/gi
                        ],
                        severity: 'medium',
                        title: 'ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒ Ø®Ø·Ø±Ù†Ø§Ú© Ø¨Ù‡ Ø²Ù…Ø§Ù†',
                        description: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² block.timestamp Ú©Ù‡ ØªÙˆØ³Ø· Ù…Ø§ÛŒÙ†Ø±Ù‡Ø§ Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªÚ©Ø§Ø±ÛŒ Ø§Ø³Øª Ùˆ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ù†ØªØ§ÛŒØ¬ ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø´ÙˆØ¯'
                    },

                    txOrigin: {
                        patterns: [
                            /tx\.origin/g
                        ],
                        antiPatterns: [
                            /msg\.sender/g
                        ],
                        severity: 'high',
                        title: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø®Ø·Ø±Ù†Ø§Ú© Ø§Ø² tx.origin',
                        description: 'tx.origin Ø¨Ù‡ Ø¬Ø§ÛŒ msg.sender Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡ Ú©Ù‡ Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ phishing Ù…ÛŒâ€ŒØ´ÙˆØ¯'
                    },

                    weakRandomness: {
                        patterns: [
                            /keccak256\s*\([^)]*block\.(timestamp|number|difficulty)[^)]*\)/g,
                            /blockhash\s*\([^)]*\)\s*%/g,
                            /block\.difficulty\s*%/g
                        ],
                        antiPatterns: [
                            /VRF/gi,
                            /oracle/gi,
                            /chainlink/gi,
                            /commit.*reveal/gi
                        ],
                        severity: 'high',
                        title: 'ØªÙˆÙ„ÛŒØ¯ Ø¹Ø¯Ø¯ ØªØµØ§Ø¯ÙÛŒ Ø¶Ø¹ÛŒÙ',
                        description: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…Ù†Ø§Ø¨Ø¹ Ù‚Ø§Ø¨Ù„ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¹Ø¯Ø¯ ØªØµØ§Ø¯ÙÛŒ Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª ØªÙˆØ³Ø· Ù…Ù‡Ø§Ø¬Ù…Ø§Ù† Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø´ÙˆØ¯'
                    },

                    delegateCall: {
                        patterns: [
                            /\.delegatecall\s*\(/g,
                            /assembly\s*\{[^}]*delegatecall[^}]*\}/gs
                        ],
                        antiPatterns: [
                            /require\s*\([^)]*success[^)]*\)/g,
                            /onlyOwner/g
                        ],
                        severity: 'critical',
                        title: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø®Ø·Ø±Ù†Ø§Ú© Ø§Ø² delegatecall',
                        description: 'delegatecall Ø¨Ø¯ÙˆÙ† Ú©Ù†ØªØ±Ù„ Ù…Ù†Ø§Ø³Ø¨ Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø¯ Ù…Ø®Ø±Ø¨ Ø¯Ø± context Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ Ø´ÙˆØ¯'
                    },

                    gasLimit: {
                        patterns: [
                            /for\s*\([^{]*\.length[^{]*\)\s*\{[^}]*\}/gs,
                            /while\s*\([^{]*\.length[^{]*\)\s*\{[^}]*\}/gs,
                            /\.push\s*\([^)]*\)[^;]*;[^}]*\.length/gs
                        ],
                        antiPatterns: [
                            /require\s*\([^)]*\.length\s*[<>][^)]*\)/g,
                            /break\s*;/g,
                            /if\s*\([^)]*gas[^)]*\)\s*break/gi
                        ],
                        severity: 'medium',
                        title: 'Ø­Ù…Ù„Ù‡ DoS Ø¨Ø§ Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ú¯Ø§Ø²',
                        description: 'Ø­Ù„Ù‚Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯ Ø±ÙˆÛŒ Ø¢Ø±Ø§ÛŒÙ‡â€ŒÙ‡Ø§ Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ø§ØªÙ…Ø§Ù… Ú¯Ø§Ø² Ùˆ Ø¹Ø¯Ù… Ø§Ø¬Ø±Ø§ÛŒ ØªØ±Ø§Ú©Ù†Ø´ Ø´ÙˆØ¯'
                    },

                    frontRunning: {
                        patterns: [
                            /function\s+\w+[^{]*public[^{]*\{[^}]*transfer[^}]*\}/gs,
                            /function\s+\w+[^{]*external[^{]*\{[^}]*approve[^}]*\}/gs,
                            /function\s+\w+[^{]*public[^{]*\{[^}]*balanceOf[^}]*\}/gs
                        ],
                        antiPatterns: [
                            /commit.*reveal/gi,
                            /timelock/gi,
                            /private/g
                        ],
                        severity: 'medium',
                        title: 'Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ Front-Running',
                        description: 'ØªÙˆØ§Ø¨Ø¹ Ø­Ø³Ø§Ø³ Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø¯Ø± Ù…Ø¹Ø±Ø¶ Ø­Ù…Ù„Ø§Øª front-running Ù‚Ø±Ø§Ø± Ø¨Ú¯ÛŒØ±Ù†Ø¯'
                    }
                };
            }

            initializeGasPatterns() {
                return {
                    inefficientLoops: /for\s*\([^)]*\)\s*\{[^}]*\.push[^}]*\}/gs,
                    storageInLoop: /for\s*\([^)]*\)\s*\{[^}]*storage[^}]*\}/gs,
                    redundantChecks: /require\s*\([^)]*\);\s*require\s*\([^)]*\);/g
                };
            }

            setupEventListeners() {
                const analyzeBtn = document.getElementById('analyzeBtn');
                const codeInput = document.getElementById('solidityCode');

                analyzeBtn.addEventListener('click', () => {
                    this.performAnalysis();
                });

                // Real-time hints (debounced)
                let timeout;
                codeInput.addEventListener('input', () => {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => {
                        this.showQuickHints();
                    }, 1000);
                });
            }

            async performAnalysis() {
                const code = document.getElementById('solidityCode').value.trim();
                
                if (!code) {
                    this.showError('Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Solidity Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                    return;
                }

                this.showLoading();
                
                // Simulate processing time for better UX
                setTimeout(() => {
                    const vulnerabilities = this.analyzeCode(code);
                    this.displayResults(vulnerabilities);
                }, 1200);
            }

            analyzeCode(code) {
                const vulnerabilities = [];

                // Deep pattern analysis
                for (const [key, pattern] of Object.entries(this.patterns)) {
                    const findings = this.detectPattern(code, pattern);
                    if (findings.length > 0) {
                        vulnerabilities.push({
                            id: key,
                            ...pattern,
                            findings,
                            lineNumbers: this.getLineNumbers(code, findings),
                            confidence: this.calculateConfidence(code, pattern),
                            gasImpact: this.assessGasImpact(key)
                        });
                    }
                }

                // Advanced contextual analysis
                vulnerabilities.push(...this.performContextualAnalysis(code));

                return vulnerabilities.sort((a, b) => 
                    this.getSeverityWeight(b.severity) - this.getSeverityWeight(a.severity)
                );
            }

            detectPattern(code, pattern) {
                const findings = [];
                let hasVulnerability = false;

                // Check vulnerability patterns
                for (const regex of pattern.patterns) {
                    const matches = [...code.matchAll(regex)];
                    if (matches.length > 0) {
                        hasVulnerability = true;
                        findings.push(...matches.map(match => ({
                            code: match[0],
                            position: match.index,
                            context: this.getContext(code, match.index)
                        })));
                    }
                }

                // Check for mitigations
                let hasMitigation = false;
                for (const antiRegex of pattern.antiPatterns) {
                    if (antiRegex.test(code)) {
                        hasMitigation = true;
                        break;
                    }
                }

                return (hasVulnerability && !hasMitigation) ? findings : [];
            }

            performContextualAnalysis(code) {
                const contextualIssues = [];

                // Check for missing events in critical functions
                if (/function\s+\w+.*payable/g.test(code) && !/emit\s+/g.test(code)) {
                    contextualIssues.push({
                        id: 'missing_events',
                        severity: 'low',
                        title: 'Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…ÙÙ‚ÙˆØ¯ Ø¯Ø± ØªÙˆØ§Ø¨Ø¹ Ù…Ù‡Ù…',
                        description: 'ØªÙˆØ§Ø¨Ø¹ Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø¯ÙˆÙ† Ø§Ù†ØªØ´Ø§Ø± Ø±ÙˆÛŒØ¯Ø§Ø¯ Ù…Ù†Ø§Ø³Ø¨ Ú©Ù‡ Ø±Ø¯ÛŒØ§Ø¨ÛŒ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ Ø±Ø§ Ø¯Ø´ÙˆØ§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯',
                        findings: [{code: 'Missing events in payable functions', position: 0}],
                        lineNumbers: []
                    });
                }

                // Check for hardcoded values
                const hardcodedValues = [...code.matchAll(/0x[a-fA-F0-9]{40}|\d{10,}/g)];
                if (hardcodedValues.length > 0) {
                    contextualIssues.push({
                        id: 'hardcoded_values',
                        severity: 'info',
                        title: 'Ù…Ù‚Ø§Ø¯ÛŒØ± Ù‡Ø§Ø±Ø¯Ú©Ø¯ Ø´Ø¯Ù‡',
                        description: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…Ù‚Ø§Ø¯ÛŒØ± Ø«Ø§Ø¨Øª Ú©Ù‡ Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±ÛŒ Ú©Ø¯ Ø±Ø§ Ú©Ø§Ù‡Ø´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯',
                        findings: hardcodedValues.map(match => ({
                            code: match[0],
                            position: match.index
                        })),
                        lineNumbers: this.getLineNumbers(code, hardcodedValues.map(m => ({position: m.index})))
                    });
                }

                // Check for floating pragma
                if (/pragma\s+solidity\s+\^/g.test(code)) {
                    contextualIssues.push({
                        id: 'floating_pragma',
                        severity: 'info',
                        title: 'Pragma Ø´Ù†Ø§ÙˆØ±',
                        description: 'Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² pragma Ø´Ù†Ø§ÙˆØ± Ú©Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ù…Ø´Ú©Ù„Ø§Øª Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ Ø´ÙˆØ¯',
                        findings: [{code: 'Floating pragma detected', position: 0}],
                        lineNumbers: []
                    });
                }

                return contextualIssues;
            }

            getContext(code, position) {
                const lines = code.split('\n');
                let currentPos = 0;
                
                for (let i = 0; i < lines.length; i++) {
                    if (currentPos <= position && position <= currentPos + lines[i].length) {
                        const start = Math.max(0, i - 2);
                        const end = Math.min(lines.length - 1, i + 2);
                        return lines.slice(start, end + 1).join('\n');
                    }
                    currentPos += lines[i].length + 1;
                }
                
                return '';
            }

            getLineNumbers(code, findings) {
                const lines = code.split('\n');
                const lineNumbers = [];
                
                findings.forEach(finding => {
                    let currentPos = 0;
                    for (let i = 0; i < lines.length; i++) {
                        if (currentPos <= finding.position && finding.position <= currentPos + lines[i].length) {
                            lineNumbers.push(i + 1);
                            break;
                        }
                        currentPos += lines[i].length + 1;
                    }
                });
                
                return [...new Set(lineNumbers)].sort((a, b) => a - b);
            }

            calculateConfidence(code, pattern) {
                let confidence = 70; // Base confidence
                
                // Increase confidence based on pattern strength
                if (pattern.patterns.length > 2) confidence += 10;
                if (pattern.antiPatterns.length > 0) confidence += 5;
                
                // Context-based adjustments
                if (code.includes('pragma solidity ^0.8')) confidence += 5;
                if (code.includes('ReentrancyGuard')) confidence -= 10;
                
                return Math.min(95, Math.max(60, confidence));
            }

            assessGasImpact(patternId) {
                const gasImpacts = {
                    reentrancy: 'high',
                    gasLimit: 'critical',
                    delegateCall: 'medium',
                    default: 'low'
                };
                
                return gasImpacts[patternId] || gasImpacts.default;
            }

            getSeverityWeight(severity) {
                const weights = { critical: 5, high: 4, medium: 3, low: 2, info: 1 };
                return weights[severity] || 0;
            }

            showLoading() {
                const btn = document.getElementById('analyzeBtn');
                const btnText = document.getElementById('btnText');
                const results = document.getElementById('results');

                btn.disabled = true;
                btnText.innerHTML = 'ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„...';
                
                results.innerHTML = `
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>ØªØ­Ù„ÛŒÙ„ Ø¹Ù…Ù‚ÛŒ Ú©Ø¯ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…...</p>
                    </div>
                `;
            }

            showError(message) {
                const results = document.getElementById('results');
                results.innerHTML = `
                    <div class="no-results">
                        âš ï¸ ${message}
                    </div>
                `;
            }

            showQuickHints() {
                const code = document.getElementById('solidityCode').value;
                if (code.length < 50) return;

                // Quick vulnerability detection for live feedback
                let hints = [];
                
                if (/\.call\s*\{/.test(code) && !/nonReentrant/.test(code)) {
                    hints.push('âš ï¸ Ø§Ø­ØªÙ…Ø§Ù„ Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ Reentrancy');
                }
                
                if (/tx\.origin/.test(code)) {
                    hints.push('ğŸš¨ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² tx.origin Ø®Ø·Ø±Ù†Ø§Ú© Ø§Ø³Øª');
                }

                // Show hints in a subtle way (could be expanded)
                console.log('Quick hints:', hints);
            }

            displayResults(vulnerabilities) {
                const btn = document.getElementById('analyzeBtn');
                const btnText = document.getElementById('btnText');
                const results = document.getElementById('results');

                btn.disabled = false;
                btnText.innerHTML = 'ğŸ” ØªØ­Ù„ÛŒÙ„ Ø§Ù…Ù†ÛŒØªÛŒ';

                if (vulnerabilities.length === 0) {
                    results.innerHTML = `
                        <div class="no-results success">
                            <div style="font-size: 3rem; margin-bottom: 20px;">âœ…</div>
                            <h3>Ù‡ÛŒÚ† Ø¢Ø³ÛŒØ¨â€ŒÙ¾Ø°ÛŒØ±ÛŒ Ø§Ù…Ù†ÛŒØªÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯!</h3>
                            <p>Ú©Ø¯ Ø´Ù…Ø§ Ø§Ø² Ù†Ø¸Ø± Ø§Ù…Ù†ÛŒØªÛŒ Ù…Ù†Ø§Ø³Ø¨ Ø§Ø³Øª.</p>
                        </div>
                    `;
                    return;
                }

                const stats = this.calculateStatistics(vulnerabilities);
                let html = this.generateStatsHTML(stats);
                
                vulnerabilities.forEach((vuln, index) => {
                    html += this.generateVulnerabilityHTML(vuln, index);
                });

                results.innerHTML = html;
                this.attachToggleListeners();
            }

            calculateStatistics(vulnerabilities) {
                return {
                    total: vulnerabilities.length,
                    critical: vulnerabilities.filter(v => v.severity === 'critical').length,
                    high: vulnerabilities.filter(v => v.severity === 'high').length,
                    medium: vulnerabilities.filter(v => v.severity === 'medium').length,
                    low: vulnerabilities.filter(v => v.severity === 'low').length,
                    info: vulnerabilities.filter(v => v.severity === 'info').length
                };
            }

            generateStatsHTML(stats) {
                return `
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number">${stats.total}</div>
                            <div class="stat-label">Ú©Ù„ Ù…Ø³Ø§Ø¦Ù„</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: var(--danger);">${stats.critical}</div>
                            <div class="stat-label">Ø¨Ø­Ø±Ø§Ù†ÛŒ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: #ea580c;">${stats.high}</div>
                            <div class="stat-label">Ø¨Ø§Ù„Ø§</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: var(--warning);">${stats.medium}</div>
                            <div class="stat-label">Ù…ØªÙˆØ³Ø·</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: var(--success);">${stats.low + stats.info}</div>
                            <div class="stat-label">Ù¾Ø§ÛŒÛŒÙ†</div>
                        </div>
                    </div>
                `;
            }

            generateVulnerabilityHTML(vuln, index) {
                const recommendations = this.getRecommendations(vuln.id);
                const codeExample = this.getSecureCodeExample(vuln.id);
                
                return `
                    <div class="vulnerability-card severity-${vuln.severity}">
                        <div class="vulnerability-header" onclick="toggleVulnerability(${index})">
                            <div>
                                <div class="vulnerability-title">${vuln.title}</div>
                                <div class="vulnerability-meta">
                                    ${vuln.findings.length} Ù…ÙˆØ±Ø¯ ÛŒØ§ÙØª Ø´Ø¯
                                    ${vuln.lineNumbers.length > 0 ? `â€¢ Ø®Ø·ÙˆØ·: ${vuln.lineNumbers.slice(0, 5).join(', ')}` : ''}
                                    ${vuln.confidence ? `â€¢ Ø§Ø¹ØªÙ…Ø§Ø¯: ${vuln.confidence}%` : ''}
                                </div>
                            </div>
                            <div>
                                <span class="severity-badge severity-${vuln.severity}">${this.getSeverityLabel(vuln.severity)}</span>
                                <span class="expand-icon" id="icon-${index}">â–¼</span>
                            </div>
                        </div>
                        <div class="vulnerability-details" id="details-${index}">
                            <p><strong>ØªÙˆØ¶ÛŒØ­Ø§Øª:</strong> ${vuln.description}</p>
                            
                            <h4>ğŸ¯ Ú©Ø¯Ù‡Ø§ÛŒ Ù…Ø´Ú©Ù„â€ŒØ¯Ø§Ø±:</h4>
                            ${vuln.findings.slice(0, 3).map(finding => 
                                `<div class="code-block">${this.escapeHtml(finding.code)}</div>`
                            ).join('')}
                            
                            ${vuln.gasImpact ? `
                                <p><strong>ØªØ£Ø«ÛŒØ± Ø¨Ø± Ú¯Ø§Ø²:</strong> <span class="severity-badge severity-${vuln.gasImpact}">${vuln.gasImpact}</span></p>
                            ` : ''}
                            
                            ${recommendations ? `
                                <div class="recommendation">
                                    <h4>ğŸ’¡ Ø±Ø§Ù‡â€ŒØ­Ù„ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:</h4>
                                    <p>${recommendations}</p>
                                </div>
                            ` : ''}
                            
                            ${codeExample ? `
                                <h4>âœ… Ù…Ø«Ø§Ù„ Ú©Ø¯ Ø§Ù…Ù†:</h4>
                                <div class="code-block">${codeExample}</div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }

            getSeverityLabel(severity) {
                const labels = {
                    critical: 'Ø¨Ø­Ø±Ø§Ù†ÛŒ',
                    high: 'Ø¨Ø§Ù„Ø§',
                    medium: 'Ù…ØªÙˆØ³Ø·',
                    low: 'Ù¾Ø§ÛŒÛŒÙ†',
                    info: 'Ø§Ø·Ù„Ø§Ø¹'
                };
                return labels[severity] || severity;
            }

            getRecommendations(vulnId) {
                const recommendations = {
                    reentrancy: 'Ø§Ø² Ø§Ù„Ú¯ÙˆÛŒ Checks-Effects-Interactions Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. Ø§Ø¨ØªØ¯Ø§ ÙˆØ¶Ø¹ÛŒØª Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯ØŒ Ø³Ù¾Ø³ ØªØºÛŒÛŒØ±Ø§Øª Ø±Ø§ Ø§Ø¹Ù…Ø§Ù„ Ú©Ù†ÛŒØ¯ØŒ Ùˆ Ø¯Ø± Ù†Ù‡Ø§ÛŒØª Ø¨Ø§ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯Ù‡Ø§ÛŒ Ø®Ø§Ø±Ø¬ÛŒ ØªØ¹Ø§Ù…Ù„ Ú©Ù†ÛŒØ¯. Ù‡Ù…Ú†Ù†ÛŒÙ† Ø§Ø² OpenZeppelin ReentrancyGuard Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.',
                    
                    uncheckedTransfer: 'Ù‡Ù…ÛŒØ´Ù‡ Ù†ØªÛŒØ¬Ù‡ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒâ€ŒÙ‡Ø§ÛŒ .call() Ùˆ .send() Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯. Ø§Ø² require() Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ù…ÙˆÙÙ‚ÛŒØª ØªØ±Ø§Ú©Ù†Ø´ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ ÛŒØ§ Ø§Ø² Ø§Ù„Ú¯ÙˆÛŒ withdrawal Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.',
                    
                    accessControl: 'Ø§Ø² modifier Ù‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø§Ù†Ù†Ø¯ onlyOwner Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. OpenZeppelin AccessControl ÛŒØ§ Ownable Ø±Ø§ Ø¨Ù‡ Ú©Ø§Ø± Ø¨Ú¯ÛŒØ±ÛŒØ¯. Ù‡Ø±Ú¯Ø² ØªÙˆØ§Ø¨Ø¹ Ø­Ø³Ø§Ø³ Ø±Ø§ Ø¨Ø¯ÙˆÙ† Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ public Ù†Ú¯Ø°Ø§Ø±ÛŒØ¯.',
                    
                    integerOverflow: 'Ø§Ú¯Ø± Ø§Ø² Solidity 0.8.0+ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯ØŒ Ø¨Ø±Ø±Ø³ÛŒâ€ŒÙ‡Ø§ÛŒ overflow Ø®ÙˆØ¯Ú©Ø§Ø± ÙØ¹Ø§Ù„ Ù‡Ø³ØªÙ†Ø¯. Ø¨Ø±Ø§ÛŒ Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒâ€ŒØªØ± Ø§Ø² OpenZeppelin SafeMath Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.',
                    
                    timestampManipulation: 'Ø§Ø² block.timestamp Ø¨Ø±Ø§ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª Ø²Ù…Ø§Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø¯Ù‚ÛŒÙ‚ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒØ¯. Ø§Ø² Oracle Ù‡Ø§ÛŒ Ø®Ø§Ø±Ø¬ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù…Ø§Ù†ÛŒ Ø­Ø³Ø§Ø³ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ ÛŒØ§ toleranceØ§ÛŒ Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ±Ø§Øª Ø²Ù…Ø§Ù†ÛŒ Ø¯Ø± Ù†Ø¸Ø± Ø¨Ú¯ÛŒØ±ÛŒØ¯.',
                    
                    txOrigin: 'Ù‡Ø±Ú¯Ø² Ø§Ø² tx.origin Ø¨Ø±Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒØ¯. Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø² msg.sender Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ ØªØ§ Ø§Ø² Ø­Ù…Ù„Ø§Øª phishing Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø´ÙˆØ¯.',
                    
                    weakRandomness: 'Ø§Ø² Oracle Ù‡Ø§ÛŒ ØªØµØ§Ø¯Ù Ø®Ø§Ø±Ø¬ÛŒ Ù…Ø§Ù†Ù†Ø¯ Chainlink VRF Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. Ù‡Ø±Ú¯Ø² Ø§Ø² block.timestampØŒ block.difficulty ÛŒØ§ block.number Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¹Ø¯Ø¯ ØªØµØ§Ø¯ÙÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ú©Ù†ÛŒØ¯.',
                    
                    delegateCall: 'Ø¨Ø³ÛŒØ§Ø± Ù…Ø­ØªØ§Ø· Ø¨Ø§Ø´ÛŒØ¯. delegatecall ØªÙ†Ù‡Ø§ Ø§Ø² Ø¢Ø¯Ø±Ø³â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ø§Ø¹ØªÙ…Ø§Ø¯ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ø´ÙˆØ¯. Ù‡Ù…ÛŒØ´Ù‡ Ù†ØªÛŒØ¬Ù‡ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯ Ùˆ Ú©Ù†ØªØ±Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ù†Ø§Ø³Ø¨ Ø§Ø¹Ù…Ø§Ù„ Ú©Ù†ÛŒØ¯.',
                    
                    gasLimit: 'Ø§Ø² Ø­Ù„Ù‚Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯ Ø±ÙˆÛŒ Ø¢Ø±Ø§ÛŒÙ‡â€ŒÙ‡Ø§ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ú©Ù†ÛŒØ¯. Ù…Ø­Ø¯ÙˆØ¯ÛŒØª ØªØ¹Ø¯Ø§Ø¯ ØªÚ©Ø±Ø§Ø± Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯ ÛŒØ§ Ø§Ø² Ø§Ù„Ú¯ÙˆÛŒ pagination Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.',
                    
                    frontRunning: 'Ø§Ø² Ø§Ù„Ú¯ÙˆÛŒ commit-reveal Ø¨Ø±Ø§ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª Ø­Ø³Ø§Ø³ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯. ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ù… Ø±Ø§ private pool Ø§Ø±Ø³Ø§Ù„ Ú©Ù†ÛŒØ¯ ÛŒØ§ Ø§Ø² timelock Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.'
                };
                
                return recommendations[vulnId] || 'Ú©Ø¯ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø±Ø¯Ù‡ Ùˆ Ø§Ø² best practice Ù‡Ø§ÛŒ Ø§Ù…Ù†ÛŒØªÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.';
            }

            getSecureCodeExample(vulnId) {
                const examples = {
                    reentrancy: `// Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ReentrancyGuard
import "@openzeppelin/contracts/security/ReentrancyGuard.sol";

function withdraw() external nonReentrant {
    uint256 amount = balances[msg.sender];
    require(amount > 0, "No funds");
    balances[msg.sender] = 0; // Effect
    payable(msg.sender).transfer(amount); // Interaction
}`,
                    
                    uncheckedTransfer: `// Ø¨Ø±Ø±Ø³ÛŒ Ù†ØªÛŒØ¬Ù‡ call
(bool success, ) = payable(recipient).call{value: amount}("");
require(success, "Transfer failed");

// ÛŒØ§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² withdrawal pattern
function withdraw() external {
    uint256 amount = pendingWithdrawals[msg.sender];
    pendingWithdrawals[msg.sender] = 0;
    payable(msg.sender).transfer(amount);
}`,
                    
                    accessControl: `// Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² modifier
modifier onlyOwner() {
    require(msg.sender == owner, "Not owner");
    _;
}

function criticalFunction() external onlyOwner {
    // ØªÙ†Ù‡Ø§ Ù…Ø§Ù„Ú© Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ø±Ø§ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ú©Ù†Ø¯
}`,
                    
                    txOrigin: `// Ø§Ø³ØªÙØ§Ø¯Ù‡ ØµØ­ÛŒØ­ Ø§Ø² msg.sender
require(msg.sender == owner, "Unauthorized");
// Ø¨Ù‡ Ø¬Ø§ÛŒ tx.origin == owner`
                };
                
                return examples[vulnId] || null;
            }

            attachToggleListeners() {
                // Event listeners are attached via onclick in HTML
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        // Global functions for HTML onclick events
        function toggleVulnerability(index) {
            const details = document.getElementById(`details-${index}`);
            const icon = document.getElementById(`icon-${index}`);
            
            if (details.classList.contains('active')) {
                details.classList.remove('active');
                icon.classList.remove('rotated');
            } else {
                details.classList.add('active');
                icon.classList.add('rotated');
            }
        }

        // Initialize the analyzer
        document.addEventListener('DOMContentLoaded', () => {
            new AdvancedSolidityAnalyzer();
        });
    </script>
</body>
</html>
